<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="gSMaswRY9iRfG4QaQrx6aj481bgr503qEZh-QPsMYNU" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="元経済学徒, 現在どっかでデータサイエンティストもどきやってる人間の勉強日記">
    <meta name="keywords"  content="Statistics, Economics, Econometrics, Python, C, Shell, Linux, Data scientist">
    <meta name="theme-color" content="#000000">
    
    <!-- Open Graph -->
    <meta property="og:title" content="awkコマンドを用いた前処理の紹介 - Ryo's Tech Blog">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="


">
    
    <meta property="article:published_time" content="2021-12-16T00:00:00Z">
    
    
    <meta property="article:author" content="Ryo">
    
    
    <meta property="article:tag" content="Linux">
    
    <meta property="article:tag" content="Shell">
    
    
    <meta property="og:image" content="https://ryonakagami.github.io/img/avatar_rio_cat.jpg">
    <meta property="og:url" content="https://ryonakagami.github.io/2021/12/16/awk-command-basic/">
    <meta property="og:site_name" content="Ryo's Tech Blog">
    
    <title>awkコマンドを用いた前処理の紹介 - Ryo's Tech Blog</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://ryonakagami.github.io/2021/12/16/awk-command-basic/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/ryo-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- https://stackoverflow.com/questions/45983301/google-pagespeed-eliminate-render-blocking-resources-above-the-fold-caused-fro -->
    <!--link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"-->
    <!--<link href="https://fonts.googleapis.com/earlyaccess/notosansjapanese.css" rel="stylesheet" type="text/css" media="print" onload="this.media='all'" > -->
    <link href="https://fonts.googleapis.com/earlyaccess/notosansjapanese.css" rel="preload" type="text/css" media="print" onload="this.media='all'" >


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->

<nav class="navbar navbar-default navbar-custom navbar-fixed-top invert">
    
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Ryo's Tech Blog</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div id="huxblog_navbar">
                <div class="navbar-collapse">
                    <ul class="nav navbar-nav navbar-left">
                                                <li>
                            <a href="https://ryonakagami.github.io/statistics-for-regression-monkey/">Statistics for
                                Regression Monkeys</a>
                        </li>
                        <li>
                            <a href="https://ohgoshgit.github.io/">OhGoshGit!?!</a>
                        </li>
                        <!-- <li>
                            <a><button onclick="mainDropDown()" style="border-color: rgba(70, 83, 111, 0.989); background-color: rgba(70, 83, 111, 0.989)">Dropdown</button></a> 
                            <div id="myDropdown" class="dropdown-content">
                              <a href="#" onclick="subMenu(this)">A</a>
                              <div class="sub-menu-item" id="subMenu1">
                              <a href="#">A.1</a>
                              </div>
                              <a href="#" onclick="subMenu(this)">B</a>
                              <div class="sub-menu-item" id="subMenu2">
                              <a href="#">B.1</a>
                              </div>
                              <a href="#">C</a>
                              <a href="#">D</a>
                              <a href="#">E</a>
                              <a href="#">F</a>
                              <a href="#">G</a>
                            </div>
                        </li> -->
                    </ul>
                    </ul>
                    <ul class="nav navbar-nav navbar-right">
                        
                        
                        
                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                        
                        
                        <li>
                            <a href="/archive/">Tag Search</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <!--about fa-search see https://stackoverflow.com/questions/41950677/how-to-make-my-search-icon-fixed-->
                        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
                            rel="stylesheet" />
                        <li class="search-icon">
                            <a href="javascript:void(0)" aria-label="Search" target="_blank">
                                <i class="fa fa-search"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <script>
        // Drop Bootstarp low-performance Navbar
        // Use customize navbar with high-quality material design animation
        // in high-perf jank-free CSS3 implementation
        var $body = document.body;
        var $toggle = document.querySelector('.navbar-toggle');
        var $navbar = document.querySelector('#huxblog_navbar');
        var $collapse = document.querySelector('.navbar-collapse');

        var __HuxNav__ = {
            close: function () {
                $navbar.className = " ";
                // wait until animation end.
                setTimeout(function () {
                    // prevent frequently toggle
                    if ($navbar.className.indexOf('in') < 0) {
                        $collapse.style.height = "0px"
                    }
                }, 400)
            },
            open: function () {
                $collapse.style.height = "auto"
                $navbar.className += " in";
            }
        }

        // Bind Event
        $toggle.addEventListener('click', function (e) {
            if ($navbar.className.indexOf('in') > 0) {
                __HuxNav__.close()
            } else {
                __HuxNav__.open()
            }
        })

        /**
         * Since Fastclick is used to delegate 'touchstart' globally
         * to hack 300ms delay in iOS by performing a fake 'click',
         * Using 'e.stopPropagation' to stop 'touchstart' event from 
         * $toggle/$collapse will break global delegation.
         * 
         * Instead, we use a 'e.target' filter to prevent handler
         * added to document close HuxNav.  
         *
         * Also, we use 'click' instead of 'touchstart' as compromise
         */
        document.addEventListener('click', function (e) {
            if (e.target == $toggle) return;
            if (e.target.className == 'icon-bar') return;
            __HuxNav__.close();
        })
    </script>

    <!-- Search -->
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/home-bg.jpg" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/home-bg.jpg');
        background: ;
    }

    
    header.intro-header .header-mask{
        width: 100%;
        height: 100%;
        position: absolute;
        background: rgba(0,0,0, 0.0);
    }
    
</style>




<header class="intro-header style-text" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/archive/?tag=Linux" title="Linux">Linux</a>
                        
                        <a class="tag" href="/archive/?tag=Shell" title="Shell">Shell</a>
                        
                    </div>
                    <h1>awkコマンドを用いた前処理の紹介</h1>
                    
                    <h2 class="subheading">awk command 1/N</h2>
                    <p>
                        公開日: 2021-12-16
                        <br>
                        更新日: 2023-09-28
                        
                    </p>
                </div>
            </div>
        </div>
    </div>
</header>







<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
         <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<div style="border-radius: 1em; border-style:solid; border-color:#D3D3D3; background-color:#F8F8F8">

  <p class="h4">  Table of Contents</p>

  <!-- START doctoc generated TOC please keep comment here to allow auto update -->
  <!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

  <ul>
    <li><a href="#awk%E3%81%A3%E3%81%A6%E3%81%AA%E3%81%AB">awkってなに？</a>
      <ul>
        <li><a href="#dependency%E3%81%A8%E8%A8%AD%E5%AE%9A">Dependencyと設定</a></li>
      </ul>
    </li>
    <li><a href="#awk%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89">awkコマンド</a>
      <ul>
        <li><a href="#awk%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%92%E4%BD%93%E9%A8%93%E3%81%99%E3%82%8B">awkコマンドを体験する</a>
          <ul>
            <li><a href="#1-15%E3%81%BE%E3%81%A7%E3%81%AEsequence%E3%81%AE%E3%81%86%E3%81%A1%E5%81%B6%E6%95%B0%E3%81%AE%E3%81%BF%E3%82%92%E6%8A%BD%E5%87%BA%E3%81%99%E3%82%8B">(1) 1~5までのsequenceのうち偶数のみを抽出する</a></li>
            <li><a href="#2-15%E3%81%BE%E3%81%A7%E3%81%AEsequence%E3%81%AE%E3%81%86%E3%81%A1%E5%81%B6%E6%95%B0%E3%81%AE%E3%81%BF%E3%82%92%E6%8A%BD%E5%87%BA%E3%81%99%E3%82%8B--%E6%8A%BD%E5%87%BA%E7%B5%90%E6%9E%9C%E3%81%AB%E5%81%B6%E6%95%B0%E3%81%A8%E3%81%84%E3%81%86%E6%96%87%E5%AD%97%E5%88%97%E3%82%92%E4%BB%98%E4%B8%8E%E3%81%99%E3%82%8B">(2) 1~5までのsequenceのうち偶数のみを抽出する &amp; 抽出結果に「偶数」という文字列を付与する</a></li>
            <li><a href="#3-15%E3%81%BE%E3%81%A7%E3%81%AEsequence%E3%81%AE%E3%81%86%E3%81%A1%E6%95%B0%E5%80%A4%E3%81%AB%E5%BF%9C%E3%81%98%E3%81%A6%E5%A5%87%E6%95%B0%E5%81%B6%E6%95%B0%E3%81%A8%E3%81%84%E3%81%86%E6%96%87%E5%AD%97%E5%88%97%E3%82%92%E4%BB%98%E4%B8%8E%E3%81%99%E3%82%8B">(3) 1~5までのsequenceのうち、数値に応じて奇数偶数という文字列を付与する</a></li>
            <li><a href="#4-15%E3%81%BE%E3%81%A7%E3%81%AEsequence%E3%81%AE%E3%81%86%E3%81%A1%E6%95%B0%E5%80%A4%E3%81%AB%E5%BF%9C%E3%81%98%E3%81%A6%E5%A5%87%E6%95%B0%E5%81%B6%E6%95%B0%E3%81%A8%E3%81%84%E3%81%86%E6%96%87%E5%AD%97%E5%88%97%E3%82%92%E4%BB%98%E4%B8%8E%E3%81%99%E3%82%8B">(4) 1~5までのsequenceのうち、数値に応じて奇数偶数という文字列を付与する</a></li>
            <li><a href="#5-awk%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%92%E7%94%A8%E3%81%84%E3%81%A6%E3%83%87%E3%82%A3%E3%82%B9%E3%82%AF%E3%81%AE%E7%A9%BA%E3%81%8D%E9%A0%98%E5%9F%9F%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B">(5) awkコマンドを用いてディスクの空き領域を表示する</a></li>
            <li><a href="#6-csv%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E5%90%84%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%E3%82%92%E6%96%87%E5%AD%97%E5%88%97%E7%B5%90%E5%90%88%E3%81%97%E3%81%A6%E8%A4%87%E6%95%B0%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B">(6) CSVファイルの各フィールドを文字列結合して複数ディレクトリを作成する</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#awk%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%92%E7%94%A8%E3%81%84%E3%81%9F%E3%83%87%E3%83%BC%E3%82%BF%E6%95%B4%E5%BD%A2">awkコマンドを用いたデータ整形</a>
      <ul>
        <li><a href="#awk%E3%81%AE%E7%B5%84%E3%81%BF%E8%BE%BC%E3%81%BF%E5%A4%89%E6%95%B0">awkの組み込み変数</a></li>
        <li><a href="#%E6%8C%87%E5%AE%9A%E3%81%97%E3%81%9F%E8%A1%8C%E3%82%92%E5%87%BA%E5%8A%9B%E3%81%99%E3%82%8B">指定した行を出力する</a></li>
        <li><a href="#row%E3%81%AEfilter">RowのFilter</a></li>
        <li><a href="#column%E3%81%AE%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%BC">Columnのフィルター</a>
          <ul>
            <li><a href="#%E7%89%B9%E5%AE%9A%E3%81%AE%E3%82%AB%E3%83%A9%E3%83%A0%E3%81%AE%E3%81%BF%E3%82%B3%E3%83%B3%E3%82%BD%E3%83%BC%E3%83%AB%E3%81%AB%E5%87%BA%E5%8A%9B%E3%81%97%E3%81%9F%E3%81%84%E5%A0%B4%E5%90%88">特定のカラムのみコンソールに出力したい場合</a></li>
            <li><a href="#%E3%82%AB%E3%83%A9%E3%83%A0%E5%88%A5%E3%81%AB%E6%9D%A1%E4%BB%B6%E3%82%92%E3%81%A4%E3%81%91%E3%81%A6%E8%A1%8C%E3%82%92%E6%8A%BD%E5%87%BA%E3%81%99%E3%82%8B">カラム別に条件をつけて行を抽出する</a></li>
            <li><a href="#%E3%82%B9%E3%82%BF%E3%83%B3%E3%83%89%E4%BD%BF%E7%94%A8%E8%80%85%E3%81%AE%E5%90%8D%E5%89%8D%E3%81%8C%E3%82%A2%E3%83%AB%E3%83%95%E3%82%A1%E3%83%99%E3%83%83%E3%83%88%E3%82%92%E5%90%AB%E3%82%80%E8%A1%8C%E3%81%AE%E3%81%BF%E6%8A%BD%E5%87%BA%E3%81%99%E3%82%8B">スタンド使用者の名前がアルファベットを含む行のみ抽出する</a></li>
          </ul>
        </li>
        <li><a href="#delimiter%E3%82%92%E5%A4%89%E6%9B%B4%E3%81%97%E3%81%A6%E5%87%BA%E5%8A%9B%E3%81%97%E3%81%9F%E3%81%84%E5%A0%B4%E5%90%88">Delimiterを変更して出力したい場合</a></li>
        <li><a href="#%E8%A4%87%E6%95%B0%E3%81%AEcsv-file%E3%82%92%E7%B5%90%E5%90%88%E3%81%97%E3%81%9F%E3%81%84%E5%A0%B4%E5%90%88">複数のcsv fileを結合したい場合</a>
          <ul>
            <li><a href="#id%E3%81%A7sort%E3%81%97%E3%81%9F%E5%BD%A2%E3%81%A7%E7%B5%90%E5%90%88%E3%81%97%E3%81%9F%E3%81%84%E5%A0%B4%E5%90%88">IDでsortした形で結合したい場合</a></li>
          </ul>
        </li>
        <li><a href="#%E7%89%B9%E5%AE%9A%E3%81%AE%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%E3%81%AE%E9%83%A8%E5%88%86%E6%96%87%E5%AD%97%E5%88%97%E3%82%92%E6%8A%BD%E5%87%BA%E3%81%97%E3%81%9F%E3%81%84%E5%A0%B4%E5%90%88substr">特定のフィールドの部分文字列を抽出したい場合：<code class="language-plaintext highlighter-rouge">substr()</code></a></li>
      </ul>
    </li>
    <li><a href="#fpat%E3%82%92%E7%94%A8%E3%81%84%E3%81%9F%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%E5%86%85%E3%81%AB%E3%82%AB%E3%83%B3%E3%83%9E%E3%81%B8%E3%81%AE%E5%AF%BE%E5%BF%9C">FPATを用いたフィールド内にカンマへの対応</a>
      <ul>
        <li><a href="#%E7%B5%84%E8%BE%BC%E5%A4%89%E6%95%B0fpat%E3%81%AE%E5%B0%8E%E5%85%A5">組込変数FPATの導入</a></li>
      </ul>
    </li>
    <li><a href="#markdown%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E7%B7%A8%E9%9B%86%E3%81%AB%E5%BD%B9%E3%81%AB%E7%AB%8B%E3%81%A4awk%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%81%AE%E7%B4%B9%E4%BB%8B">Markdownファイルの編集に役に立つawkコマンドの紹介</a>
      <ul>
        <li><a href="#%E9%A0%86%E5%BA%8F%E4%BB%98%E3%81%8D%E3%83%AA%E3%82%B9%E3%83%88%E3%81%AE%E6%95%B4%E5%BD%A2">順序付きリストの整形</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>

  <!-- END doctoc generated TOC please keep comment here to allow auto update -->

</div>

<h2 id="awkってなに">awkってなに？</h2>

<ul>
  <li>テキストデータをいろいろ加工したり処理したりする際（＝前処理）に活躍するシェルコマンド</li>
  <li>ワンライナーで活躍してくれます</li>
</ul>

<h3 id="dependencyと設定">Dependencyと設定</h3>

<p>今回は <code class="language-plaintext highlighter-rouge">gawk</code> ベースで紹介します. <code class="language-plaintext highlighter-rouge">gawk</code>が入っていない場合は以下のラインでインストール:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">sudo </span>apt <span class="nb">install </span>gawk
</pre></td></tr></tbody></table></code></pre></div></div>

<p>インストールすると <code class="language-plaintext highlighter-rouge">awk</code> コマンドは <code class="language-plaintext highlighter-rouge">gawk</code> を参照しているはずです. その確認方法は、</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre> % <span class="nb">sudo </span>update-alternatives <span class="nt">--display</span> <span class="nb">awk
awk</span> - auto mode
  <span class="nb">link </span>best version is /usr/bin/gawk
  <span class="nb">link </span>currently points to /usr/bin/gawk
  <span class="nb">link awk </span>is /usr/bin/awk
  slave awk.1.gz is /usr/share/man/man1/awk.1.gz
  slave nawk is /usr/bin/nawk
  slave nawk.1.gz is /usr/share/man/man1/nawk.1.gz
/usr/bin/gawk - priority 10
  slave awk.1.gz: /usr/share/man/man1/gawk.1.gz
  slave nawk: /usr/bin/gawk
  slave nawk.1.gz: /usr/share/man/man1/gawk.1.gz
/usr/bin/mawk - priority 5
  slave awk.1.gz: /usr/share/man/man1/mawk.1.gz
  slave nawk: /usr/bin/mawk
  slave nawk.1.gz: /usr/share/man/man1/mawk.1.gz
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="awkコマンド">awkコマンド</h2>

<ul>
  <li>簡単な行ベースのテキストファイルを処理するコマンド</li>
  <li>演算機能もあり、プログラミング言語としても使用されています</li>
  <li>イメージとしては <code class="language-plaintext highlighter-rouge">grep</code> にプログラム機能をつけたコマンド</li>
</ul>

<blockquote>
  <p>Syntax</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="o">[</span>option] <span class="o">[</span><span class="nb">command</span><span class="o">]</span> <span class="o">[</span>file path]
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>Option一覧</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th>短いオプション</th>
      <th>長いオプション</th>
      <th>意味</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">-f program-file</code></td>
      <td><code class="language-plaintext highlighter-rouge">--file program-file</code></td>
      <td>awk への第 1 引数を用いるかわりに、<br />AWK プログラムをファイル program-file から読み込む</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">-F fs</code></td>
      <td><code class="language-plaintext highlighter-rouge">--field-separator fs</code></td>
      <td>入力フィールドセパレータ (変数 FS の値)をfsする<br /> field seperatorのdefaultはwhite space</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">-v var=val</code></td>
      <td><code class="language-plaintext highlighter-rouge">--assign var=val</code></td>
      <td>プログラムを実行する前に、変数 var に値 val を設定</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>awkで使用できる主な組み込み変数</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th>変数名</th>
      <th>意味</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ARGC</td>
      <td>引数の個数</td>
    </tr>
    <tr>
      <td>ARGV</td>
      <td>引数（配列）</td>
    </tr>
    <tr>
      <td>ENVIRON</td>
      <td>環境変数を収めた連想配列。例えば環境変数LANGならばENVIRON[“LANG”]と参照できる</td>
    </tr>
    <tr>
      <td>FILENAME</td>
      <td>現在処理しているファイルの名前</td>
    </tr>
    <tr>
      <td>FNR</td>
      <td>現在処理しているファイルのレコード番号</td>
    </tr>
    <tr>
      <td>FS</td>
      <td>フィールドの区切り文字（-Fオプションで変更可能、デフォルトはスペース）</td>
    </tr>
    <tr>
      <td>NR</td>
      <td>現在処理しているレコード番号（行番号）</td>
    </tr>
    <tr>
      <td>OFS</td>
      <td>出力時のフィールドの区切り（デフォルトは空白）</td>
    </tr>
    <tr>
      <td>ORS</td>
      <td>出力時のレコードの区切り（デフォルトは改行）</td>
    </tr>
    <tr>
      <td>RS</td>
      <td>レコードの区切り（デフォルトは改行）</td>
    </tr>
  </tbody>
</table>

<h3 id="awkコマンドを体験する">awkコマンドを体験する</h3>

<h4 id="1-15までのsequenceのうち偶数のみを抽出する">(1) 1~5までのsequenceのうち偶数のみを抽出する</h4>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>% <span class="nb">seq </span>5 | <span class="nb">awk</span> <span class="s1">'/[24]/'</span>
2
4
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">awk /正規表現/</code>で<code class="language-plaintext highlighter-rouge">grep 正規表現</code>と同じ挙動になります. 別の書き方として2で割り切れる数値が偶数であること利用して次のような書き方も可能です.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>% <span class="nb">seq </span>5 | <span class="nb">awk</span> <span class="s1">'$1%2==0'</span>
2
4
</pre></td></tr></tbody></table></code></pre></div></div>

<p>awkコマンドにシングルクォートで囲まれた箇所の中の<code class="language-plaintext highlighter-rouge">$1</code>は読み込んだ行の一列目を意味します. 
awkコマンドはzshやbashといったシェルで定義された関数以外にawkの中で定義された関数を呼び出して前処理を実行します.</p>

<p>そのため、「awk独自の関数に基づいた命令です」ということを明示する必要がありますが、
これが理由でawkコマンドにシングルクォートで囲った範囲が出てくると考えてください.</p>

<h4 id="2-15までのsequenceのうち偶数のみを抽出する--抽出結果に偶数という文字列を付与する">(2) 1~5までのsequenceのうち偶数のみを抽出する &amp; 抽出結果に「偶数」という文字列を付与する</h4>

<blockquote>
  <p>解答</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>% <span class="nb">seq </span>5 | <span class="nb">awk</span> <span class="s1">'$1%2==0{printf("%s, 偶数\n", $1)}'</span>
2, 偶数
4, 偶数
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>別解</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">seq </span>5 | <span class="nb">awk</span> <span class="s1">'$1%2==0{print($1, "偶数")}'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>今回は、抽出結果に「偶数」という文字列を付与して出力したいので、何かしらの形で「偶数」という文字列を<code class="language-plaintext highlighter-rouge">printf</code>に与える必要があります. 
出力したい文字列はダブルクォートで囲むことで実現できます. シングルクォートだとawkコマンド適応領域という意味とコンフリクトしてしまうので、「ダブルクォート」と理解すると覚えやすいです.</p>

<p>はじめに、偶奇判定のgrep（前提条件コマンド）を実行してから、<code class="language-plaintext highlighter-rouge">{}</code>で囲まれたawkコマンドを実行しています.</p>

<h4 id="3-15までのsequenceのうち数値に応じて奇数偶数という文字列を付与する">(3) 1~5までのsequenceのうち、数値に応じて奇数偶数という文字列を付与する</h4>

<blockquote>
  <p>解答</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>% <span class="nb">seq </span>5 | <span class="nb">awk</span> <span class="s1">'$1%2==0{print($1, "偶数")}$1%2{print($1, "奇数")}'</span>
1 奇数
2 偶数
3 奇数
4 偶数
5 奇数
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>別解</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>% <span class="nb">seq </span>5 | <span class="nb">awk</span> <span class="s1">'{a = ""; $1%2 ? a = "奇数" :a = "偶数"; print($1, a)}'</span>
1 奇数
2 偶数
3 奇数
4 偶数
5 奇数
</pre></td></tr></tbody></table></code></pre></div></div>

<p>「別解」では、<code class="language-plaintext highlighter-rouge">CONDITION ? 真の場合に返す値 : 偽の場合に返す値</code>という三項演算子を用いて記述しています. 
awkコマンドのフロートしては、</p>

<ol>
  <li>変数<code class="language-plaintext highlighter-rouge">a</code>を空文字で定義</li>
  <li>三項演算子を用いて<code class="language-plaintext highlighter-rouge">a</code>をアップデート</li>
  <li>読み込んだテキストの一列目とその値に応じた<code class="language-plaintext highlighter-rouge">a</code>をターミナルに出力</li>
</ol>

<p>という３つのコマンドを実行しています. この３つのコマンドの接続方法は、セミコロン<code class="language-plaintext highlighter-rouge">;</code>でコマンドをつなぐことで可能となります.</p>

<h4 id="4-15までのsequenceのうち数値に応じて奇数偶数という文字列を付与する">(4) 1~5までのsequenceのうち、数値に応じて奇数偶数という文字列を付与する</h4>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">seq </span>5 | <span class="nb">awk</span> <span class="s1">'BEGIN{a=0}$1%2==0{print($1, "偶数")}$1%2{print($1, "奇数")}{a+=$1}END{print("合計", a)}'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">BEGIN</code>, <code class="language-plaintext highlighter-rouge">END</code>は、それぞれ「awkが１行目の処理を始める前」「awkが最終行の処理を終えた後」という状況にマッチします.</li>
  <li>上記は、最初に変数 a を0に初期化して、行の処理のたびに+1のincrementを実施し、最後にその時のaの状態を出力するという処理です.</li>
</ul>

<h4 id="5-awkコマンドを用いてディスクの空き領域を表示する">(5) awkコマンドを用いてディスクの空き領域を表示する</h4>

<blockquote>
  <p>解答</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>% <span class="nb">df</span> <span class="nt">-m</span> | <span class="nb">awk</span> <span class="s1">'NR==1 {print "1G-Blocks", "GB-"$4}; NR&gt;=2 {x+=$2/(2**10); y+=$4/(2**10)}; END {print x, y}'</span>
1G-Blocks GB-Available
541.072 458.293
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>「df」を実行すると、ディスクの空き領域が表示されます</li>
  <li><code class="language-plaintext highlighter-rouge">-m</code> optionは指定したサイズの倍数で表示するオプション（MB単位）</li>
</ul>

<blockquote>
  <p>別解</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">df</span> <span class="nt">-h</span> <span class="nt">--total</span>  
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="6-csvファイルの各フィールドを文字列結合して複数ディレクトリを作成する">(6) CSVファイルの各フィールドを文字列結合して複数ディレクトリを作成する</h4>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>%ls
test.csv
% <span class="nb">cat </span>test.csv
store_name,store_code
a,100
b,101
c,101
</pre></td></tr></tbody></table></code></pre></div></div>

<p>上記のように<code class="language-plaintext highlighter-rouge">test.csv</code>の2つのfieldに<code class="language-plaintext highlighter-rouge">store_name,store_code</code>がカレントワーキングディレクトリに格納されているとします.
この２つのfieldを組合せて、<code class="language-plaintext highlighter-rouge">&lt;store_name&gt;_&lt;store_code&gt;</code>というdirectoryをカレントワーキングディレクトリ以下に作成したいとします.
この場合のshell scriptは以下.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="nt">-F</span> <span class="s2">","</span> <span class="s1">'NR&gt;1{print $1"_"$2}'</span> test.csv| <span class="nb">awk</span> <span class="s1">'{system("mkdir "$1)}'</span>
% <span class="nb">ls
</span>a_100/  b_101/  c_101/  test.csv
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>解説</p>
</blockquote>

<p><code class="language-plaintext highlighter-rouge">awk -F "," 'NR&gt;1{print $1"_"$2}' test.csv</code>と<code class="language-plaintext highlighter-rouge">awk '{system("mkdir "$1)}'</code>の２つのパートに分けて考えます.
前者はCSVファイルをカンマセパレートで各カラムをREADし、それらを文字列結合し出力しています. その後、その出力結果を後者に渡して<code class="language-plaintext highlighter-rouge">system()</code>でLinuxコマンドを<code class="language-plaintext highlighter-rouge">awk</code>の中で呼び、
<code class="language-plaintext highlighter-rouge">mkdir</code>でディレクトリを作成しています.</p>

<h2 id="awkコマンドを用いたデータ整形">awkコマンドを用いたデータ整形</h2>

<blockquote>
  <p>このセクションで用いるデータ</p>
</blockquote>

<ul>
  <li>ソース：<a href="http://jinbei.s58.xrea.com/data_ability.htm">スタンドパラメータ - 甚平 - ジョジョの奇妙な冒険</a></li>
  <li>ファイル名: <code class="language-plaintext highlighter-rouge">example.csv</code></li>
  <li>クリップボードにコピーした後、<code class="language-plaintext highlighter-rouge">xclip -out -selection clipboard &gt; example.csv</code>で簡単に複製できます</li>
</ul>

<pre><code class="language-csv">ID,stand_name,user_name,power,speed,range,duration,agility,growth
001,スタープラチナ,空条承太郎,A,A,C,A,A,A
002,マジシャンズレッド,モハメド･アヴドゥル,B,B,C,B,C,D
003,ハーミットパープル,ジョセフ･ジョースター,D,C,D,A,D,E
004,ハイエロファントグリーン,花京院典明,C,B,A,B,C,D
005,タワー･オブ･グレー,グレーフライ,E,A,A,C,E,E
006,シルバーチャリオッツ,J･P･ポルナレフ,C,A,C,B,B,C
007,ダークブルームーン,キャプテン･テニール,C,C,C,B,C,D
008,力・ストレングス,フォーエバー,B,D,D,A,E,E
009,エボニーデビル,呪いのデーボ,D,D,A,B,D,B
010,イエローテンパランス,ラバーソール,D,C,E,A,E,D
011,ハングドマン,J･ガイル,C,A,A,B,D,D
012,エンペラー,ホル･ホース,B,B,B,C,E,E
013,エンプレス,ネーナ,C,E,A,A,D,D
014,ホウィール･オブ･フォーチュン,ズィー･ズィー,B,D,D,A,E,D
015,ジャスティス,エンヤ婆,D,E,A,A,E,E
016,ラバーズ,鋼入りのダン,E,D,A,A,D,E
017,サン,アラビア･ファッツ,B,E,A,A,E,E
018,デス･サーティーン,マニッシュ･ボーイ,C,C,E,B,D,B
019,ジャッジメント,カメオ,B,B,C,B,D,D
020,ハイプリエステス,ミドラー,C,B,A,A,D,D
021,ザ･フール,イギー,B,C,D,C,D,C
022,ゲブ神,ンドゥール,C,B,A,B,D,D
023,トト神,ボインゴ,E,E,E,A,E,E
024,クヌム神,オインゴ,E,E,E,A,E,E
025,アヌビス神,キャラバン･サライ,B,B,E,A,E,C
026,バステト女神,マライア,E,E,B,A,E,E
027,セト神,アレッシー,D,D,E,C,D,D
028,オシリス神,ダニエル･J･ダービー,E,D,D,C,D,D
029,ホルス神,ペット･ショップ,B,B,D,C,E,C
030,アトゥム神,テレンス･T･ダービー,D,C,D,B,D,D
031,ティナー･サックス,ケニー･G,E,E,D,A,E,E
032,クリーム,ヴァニラ･アイス,B,B,D,C,C,D
033,ザ･ワールド,DIO,A,A,C,A,B,B
</code></pre>

<h3 id="awkの組み込み変数">awkの組み込み変数</h3>

<table>
  <thead>
    <tr>
      <th>変数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>NR</td>
      <td>the current number of the input records</td>
    </tr>
    <tr>
      <td>NF</td>
      <td>the number of fields of the current record</td>
    </tr>
    <tr>
      <td>FS</td>
      <td>The input field separator<br />defaultはwhite space<br />FSで区切り文字を設定できる</td>
    </tr>
    <tr>
      <td>RS</td>
      <td>The input record separator<br />defaultは改行</td>
    </tr>
    <tr>
      <td>OFS</td>
      <td>The output field separator<br />print出力時のfieldの区切り文字を指定</td>
    </tr>
    <tr>
      <td>ORS</td>
      <td>The output record separator<br />print出力時のrecordの区切り文字</td>
    </tr>
    <tr>
      <td>FPAT</td>
      <td>The input field pattern<br />どのようなパターンをフィールドとして認識するかを定義することができる</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>例題 (1) 各レコードのfieldの数を出力する</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="nt">-F</span> <span class="s2">","</span> <span class="s1">'{print NF, $0}'</span> example.csv | <span class="nb">head</span> <span class="nt">-n</span> 5
9 ID,stand_name,user_name,power,speed,range,duration,agility,growth
9 001,スタープラチナ,空条承太郎,A,A,C,A,A,A
9 002,マジシャンズレッド,モハメド･アヴドゥル,B,B,C,B,C,D
9 003,ハーミットパープル,ジョセフ･ジョースター,D,C,D,A,D,E
9 004,ハイエロファントグリーン,花京院典明,C,B,A,B,C,D
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>例題 (2) ファイルの行数を出力する</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'END {print NR}'</span> example.csv
34
</pre></td></tr></tbody></table></code></pre></div></div>

<p>or, シンプルに<code class="language-plaintext highlighter-rouge">wc</code>コマンドを用いて改行数をカウントして</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>% <span class="nb">cat </span>example.csv | <span class="nb">wc</span> <span class="nt">-l</span>
33
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="指定した行を出力する">指定した行を出力する</h3>

<blockquote>
  <p>先頭５行を表示したい場合</p>
</blockquote>

<p>任意の先頭の行数を出力したい場合は、一般的には<code class="language-plaintext highlighter-rouge">head</code>コマンドを用います.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>% <span class="nb">head</span> <span class="nt">-n</span> 5 example.csv
ID,stand_name,user_name,power,speed,range,duration,agility,growth
001,スタープラチナ,空条承太郎,A,A,C,A,A,A
002,マジシャンズレッド,モハメド･アヴドゥル,B,B,C,B,C,D
003,ハーミットパープル,ジョセフ･ジョースター,D,C,D,A,D,E
004,ハイエロファントグリーン,花京院典明,C,B,A,B,C,D
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">awk</code>コマンドを用いて表示する場合は</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'NR&lt;=5 {print}'</span> example.csv
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>６行目から10行目を表示したい場合</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'NR&lt;=10 &amp;&amp; NR&gt;=6 {print}'</span> example.csv
005,タワー･オブ･グレー,グレーフライ,E,A,A,C,E,E
006,シルバーチャリオッツ,J･P･ポルナレフ,C,A,C,B,B,C
007,ダークブルームーン,キャプテン･テニール,C,C,C,B,C,D
008,力・ストレングス,フォーエバー,B,D,D,A,E,E
009,エボニーデビル,呪いのデーボ,D,D,A,B,D,B
</pre></td></tr></tbody></table></code></pre></div></div>

<p>headerを含めたい場合は</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'(NR&lt;=10 &amp;&amp; NR&gt;=6)||(NR==1) {print}'</span> example.csv
ID,stand_name,user_name,power,speed,range,duration,agility,growth
005,タワー･オブ･グレー,グレーフライ,E,A,A,C,E,E
006,シルバーチャリオッツ,J･P･ポルナレフ,C,A,C,B,B,C
007,ダークブルームーン,キャプテン･テニール,C,C,C,B,C,D
008,力・ストレングス,フォーエバー,B,D,D,A,E,E
009,エボニーデビル,呪いのデーボ,D,D,A,B,D,B
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="rowのfilter">RowのFilter</h3>

<blockquote>
  <p>承太郎を含む行を抽出する場合</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'/承太郎/ {print}'</span> example.csv
001,スタープラチナ,空条承太郎,A,A,C,A,A,A
</pre></td></tr></tbody></table></code></pre></div></div>

<p>headerを含めたい場合は、</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'/承太郎/||(NR==1) {print}'</span> example.csv
ID,stand_name,user_name,power,speed,range,duration,agility,growth
001,スタープラチナ,空条承太郎,A,A,C,A,A,A
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>承太郎 or Dioを含む行を抽出する場合</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'/承太郎|DIO/ {print}'</span> example.csv
001,スタープラチナ,空条承太郎,A,A,C,A,A,A
033,ザ･ワールド,DIO,A,A,C,A,B,B
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>Jという文字列を含む行のうちポルという文字列があとに続く行を抽出</p>
</blockquote>

<p>Jという文字列を含む行は３つあります</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'/J/ {print}'</span> example.csv 
006,シルバーチャリオッツ,J･P･ポルナレフ,C,A,C,B,B,C
011,ハングドマン,J･ガイル,C,A,A,B,D,D
028,オシリス神,ダニエル･J･ダービー,E,D,D,C,D,D
</pre></td></tr></tbody></table></code></pre></div></div>

<p>このうち、「ポル」という文字列が後に出現する行を抽出したい場合は</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'/J.*ポル/ {print}'</span> example.csv 
006,シルバーチャリオッツ,J･P･ポルナレフ,C,A,C,B,B,C
</pre></td></tr></tbody></table></code></pre></div></div>

<p>または、</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'/J.{1,}ポル/ {print}'</span> example.csv
006,シルバーチャリオッツ,J･P･ポルナレフ,C,A,C,B,B,C
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>「神」という文字を含む行を除外して出力したい場合</p>
</blockquote>

<p>スターダストクルセイダースは「オシリス神」など「神」を名前に含むスタンドが数体出現します. それらを除くスタンダ一覧を表示したいとします</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'!/神/ {print}'</span> example.csv
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="columnのフィルター">Columnのフィルター</h3>

<h4 id="特定のカラムのみコンソールに出力したい場合">特定のカラムのみコンソールに出力したい場合</h4>

<ul>
  <li>シンボル<code class="language-plaintext highlighter-rouge">$</code>と数字の組合せを用いることで特定のカラムを指定することができます</li>
  <li>field seperatorのdefaultはwhite spaceなので、csv fileを対象に操作するときは <code class="language-plaintext highlighter-rouge">FS = ","</code>の指定をします</li>
  <li>スタンドと使用者の組をここでは抽出したいとします</li>
</ul>

<blockquote>
  <p>解答</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="nt">-F</span> <span class="s1">','</span> <span class="s1">'{print $2, $3}'</span> example.csv
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>別解</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'{print $2, $3}'</span> <span class="nv">FS</span><span class="o">=</span><span class="s1">','</span> example.csv
</pre></td></tr></tbody></table></code></pre></div></div>

<p>or</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'BEGIN{FS=","} {print $2, $3}'</span> example.csv
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="カラム別に条件をつけて行を抽出する">カラム別に条件をつけて行を抽出する</h4>

<ul>
  <li>power, speed fieldがAのスタンドのみを抽出したいとします</li>
  <li>header行も出力したいとします</li>
</ul>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="nt">-F</span> <span class="s1">','</span> <span class="s1">'NR==1 || ($4=="A" &amp;&amp; $5 == "A") {print $2, $3}'</span> example.csv
stand_name user_name
スタープラチナ 空条承太郎
ザ･ワールド DIO
</pre></td></tr></tbody></table></code></pre></div></div>

<p>IDが５以下の行のみを抽出したい場合は</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="nt">-F</span><span class="s2">","</span> <span class="s1">'$1&lt;5{print $0}'</span> example.csv
001,スタープラチナ,空条承太郎,A,A,C,A,A,A
002,マジシャンズレッド,モハメド･アヴドゥル,B,B,C,B,C,D
003,ハーミットパープル,ジョセフ･ジョースター,D,C,D,A,D,E
004,ハイエロファントグリーン,花京院典明,C,B,A,B,C,D
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="スタンド使用者の名前がアルファベットを含む行のみ抽出する">スタンド使用者の名前がアルファベットを含む行のみ抽出する</h4>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="nt">-F</span><span class="s2">","</span> <span class="s1">'NR==1 || $3~/[A-Za-z]/{print $0}'</span> example.csv
ID,stand_name,user_name,power,speed,range,duration,agility,growth
006,シルバーチャリオッツ,J･P･ポルナレフ,C,A,C,B,B,C
011,ハングドマン,J･ガイル,C,A,A,B,D,D
028,オシリス神,ダニエル･J･ダービー,E,D,D,C,D,D
030,アトゥム神,テレンス･T･ダービー,D,C,D,B,D,D
031,ティナー･サックス,ケニー･G,E,E,D,A,E,E
033,ザ･ワールド,DIO,A,A,C,A,B,B
</pre></td></tr></tbody></table></code></pre></div></div>

<p>もし「スタンド使用者の名前がアルファベットを含まない行のみ抽出」したい場合は</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="nt">-F</span><span class="s2">","</span> <span class="s1">'NR==1 || $3!~/[A-Za-z]/{print $0}'</span> example.csv
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="delimiterを変更して出力したい場合">Delimiterを変更して出力したい場合</h3>

<ul>
  <li>csvファイルをtsvとして出力します</li>
</ul>

<blockquote>
  <p>解答</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'BEGIN{FS=",";OFS="\t"} {for(i=1;i&lt;=NF-1;i++) printf $i" "; print ""}'</span> example.csv <span class="o">&gt;</span> example.tsv
% <span class="nb">head</span> <span class="nt">-n</span> 5 example.tsv 
ID stand_name user_name power speed range duration agility 
001 スタープラチナ 空条承太郎 A A C A A 
002 マジシャンズレッド モハメド･アヴドゥル B B C B C 
003 ハーミットパープル ジョセフ･ジョースター D C D A D 
004 ハイエロファントグリーン 花京院典明 C B A B C 
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>別解: gsub</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'gsub(",","\t")'</span> example.csv
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>gsub functionはglobal substitutionの略</li>
</ul>

<blockquote>
  <p>別解: sed version</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">sed</span> <span class="s1">'s/,/\t/g'</span> example.csv <span class="o">&gt;</span> example.tsv
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>この時、<code class="language-plaintext highlighter-rouge">-i</code> optionはつけないこと</li>
</ul>

<h3 id="複数のcsv-fileを結合したい場合">複数のcsv fileを結合したい場合</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">example_2.csv</code>という以下のファイルを準備します. このファイルと<code class="language-plaintext highlighter-rouge">example.csv</code>のファイルを結合し、新たな<code class="language-plaintext highlighter-rouge">merged_with_header.csv</code>を作りたいとします.</li>
</ul>

<blockquote>
  <p>Data</p>
</blockquote>

<pre><code class="language-csv">ID,stand_name,user_name,power,speed,range,duration,agility,growth
034,クレイジー･ダイヤモンド,東方仗助,A,A,D,B,B,C
035,アクア･ネックレス,片桐安十朗,C,C,A,A,C,E
036,ザ･ハンド,虹村億泰,B,B,D,C,C,C
037,バッド･カンパニー,虹村形兆,B,B,C,B,C,C
038,レッド･ホット･チリ･ペッパー,音石明,A,A,A,A,C,A
039,錠前,小林玉美,E,E,A,A,E,E
040,エコーズACT1,広瀬康一,E,E,B,B,C,A
041,サーフィス,間田敏和,B,B,C,B,C,C
042,ラブ･デラックス,山岸由花子,B,B,C,A,E,B
043,エコーズACT2,広瀬康一,C,D,B,B,C,A
044,パール･ジャム,トニオ･トラサルディー,E,C,B,A,E,C
045,アクトン･ベイビー,静･ジョースター,E,E,なし,A,E,A
046,ヘブンズ･ドアー,岸辺露伴,D,B,B,B,C,A
047,ラット,虫喰い＆虫喰いでない,B,C,D,B,E,C
048,ハーヴェスト,矢安宮重清,E,B,A,A,E,C
049,キラークイーン,吉良吉影,A,B,D,B,B,A
050,シンデレラ,辻彩,D,C,C,C,A,C
051,シアーハートアタック,吉良吉影,A,C,A,A,E,A
052,エコーズACT3,広瀬康一,B,B,C,B,C,A
053,アトム･ハート･ファーザー,吉良吉廣,E,E,なし,A,E,E
054,ボーイ･Ⅱ･マン,大柳賢,C,B,C,A,C,C
055,アース･ウインド･アンド･ファイヤー,支倉未起隆,C,C,なし,A,C,C
056,ハイウェイ･スター,墳上裕也,C,B,A,A,E,C
057,ストレイ･キャット,猫草,B,E,なし,A,E,C
058,スーパー･フライ,鋼田一豊大,E,E,なし,A,E,E
059,エニグマ,宮本輝之輔,E,E,C,A,C,C
060,チープ･トリック,乙雅三,E,E,E,A,E,E
061,キラークイーン・バイツァ･ダスト,吉良吉影,B,B,A,A,D,A
</code></pre>

<blockquote>
  <p>解答</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'(NR == 1) || (FNR &gt; 1)'</span> <span class="k">*</span>.csv <span class="o">&gt;</span> merged_with_header.csv
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>必ずしもIDはsortされていないことに注意</li>
  <li><code class="language-plaintext highlighter-rouge">NR == 1</code> は最初に読み込んだファイルの先頭行という意味</li>
  <li>FNRは処理しているファイルの行を意味します</li>
</ul>

<p>もし,headerを除去してmergedしたい場合は</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">awk</span> <span class="s1">'(FNR &gt; 1)'</span> <span class="k">*</span>.csv <span class="o">&gt;</span> merged_without_header.csv
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="idでsortした形で結合したい場合">IDでsortした形で結合したい場合</h4>

<blockquote>
  <p>csvsort</p>
</blockquote>

<ul>
  <li>この手法はIDの表現が変わってしまうので非推奨</li>
</ul>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>% csvsort merged_with_header.csv <span class="o">&gt;</span> sorted_merged.csv
% <span class="nb">head</span> <span class="nt">-n</span> 5 sorted_merged.csv
ID,stand_name,user_name,power,speed,range,duration,agility,growth
1,スタープラチナ,空条承太郎,A,A,C,A,A,A
2,マジシャンズレッド,モハメド･アヴドゥル,B,B,C,B,C,D
3,ハーミットパープル,ジョセフ･ジョースター,D,C,D,A,D,E
4,ハイエロファントグリーン,花京院典明,C,B,A,B,C,D
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>headとtailの組合せでsort (推奨)</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">head</span> <span class="nt">-n1</span> merged_with_header.csv <span class="o">&amp;&amp;</span> <span class="nb">tail</span> <span class="nt">-n</span>+2 merged_with_header.csv | <span class="nb">sort</span> <span class="o">&gt;</span> sorted_merged_2.csv
</pre></td></tr></tbody></table></code></pre></div></div>

<p>なお、<code class="language-plaintext highlighter-rouge">csvsort</code>で作成したファイルとの差分の行数を確認すると</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>% diff <span class="nt">-u</span> sorted_merged.csv sorted_merged_2.csv | <span class="nb">awk</span> <span class="s1">'NR&gt;3  &amp;&amp; /+/{print NR}'</span> | <span class="nb">wc</span> <span class="nt">-l</span>
61
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="特定のフィールドの部分文字列を抽出したい場合substr">特定のフィールドの部分文字列を抽出したい場合：<code class="language-plaintext highlighter-rouge">substr()</code></h3>

<p>特定のフィールドの部分文字列を抽出したいとします.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">echo</span> <span class="s2">"2021/09/01 09:00:00 UTC,10,200,3000"</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>上記の文字列から日付部分のみ, <code class="language-plaintext highlighter-rouge">2021/09/01</code>を抽出したい場合、<code class="language-plaintext highlighter-rouge">substr()</code>関数を用いることで
文字列の頭n文字目からm文字を抜き出して表示することができます.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>% <span class="nb">echo</span> <span class="s2">"2021/09/01 09:00:00 UTC,10,200,3000"</span>|awk <span class="nt">-F</span>, <span class="s1">'BEGIN{OFS=","}{print substr($1, 1, 10),$2,$3,$4}'</span>
2021/09/01,10,200,3000
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>末尾から文字を抜き出したい場合</p>
</blockquote>

<p><code class="language-plaintext highlighter-rouge">123456789, abcdefghijklmn</code>というレコードが与えられた時、カンマセパレートでそれぞれのフィールドから後ろから数えて５文字を抽出したいとします.
<code class="language-plaintext highlighter-rouge">substr(field, start, length)</code>のうちlengthを省略すると、startから文末までを抽出してくれる機能を利用します.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>% <span class="nb">echo</span> <span class="s2">"123456789, abcdefghijklmn"</span>|awk <span class="nt">-F</span>, <span class="s1">'{print substr($1, length($1)-4), substr($2, length($2)-4)}'</span>
56789 jklmn
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="fpatを用いたフィールド内にカンマへの対応">FPATを用いたフィールド内にカンマへの対応</h2>

<p>CSVファイルには「フィールド内にカンマを含む場合にはフィールドをダブルクォートで括る」というルールがあります. 文字列内に<code class="language-plaintext highlighter-rouge">,</code>が含まれるケースや、売上金額などの数値データで初期設定の関係で3桁カンマ区切りのデータが含まれるCSVファイルを扱うとき、単純に <code class="language-plaintext highlighter-rouge">awk -F","</code>と指定してしまうと、自分では想定していない形でフィールドが定義される可能性があります.</p>

<blockquote>
  <p>例：文字列内にカンマを含むケース</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>% <span class="nb">echo</span> <span class="s1">'"¥10,000",¥100,"¥99,000"'</span> |awk <span class="nt">-F</span><span class="s2">","</span> <span class="s1">'{print $2}'</span>
000<span class="s2">"
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">¥100</code>が期待される出力結果ですが、<code class="language-plaintext highlighter-rouge">"¥10,000"</code>の<code class="language-plaintext highlighter-rouge">000"</code>が出力されてしまいます.</p>

<h3 id="組込変数fpatの導入">組込変数FPATの導入</h3>

<p>いままではフィールドセパレーターを定義して<code class="language-plaintext highlighter-rouge">awk</code>コマンドを用いていましたが、
フィールド内にカンマが含まれる場合はフィールドのパターンを定義することで対応することができます. 例として、</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>% <span class="nb">echo</span> <span class="s1">'"¥10,000",¥100,"¥99,000"'</span> |awk <span class="nt">-v</span> <span class="nv">FPAT</span><span class="o">=</span><span class="s1">'([^,]+)|(\"[^\"]+\")'</span> <span class="s1">'{print $2}'</span>     
¥100
</pre></td></tr></tbody></table></code></pre></div></div>

<p>上記の例では<code class="language-plaintext highlighter-rouge">([^,]+)|(\"[^\"]+\")</code>という正規表現をFPATに指定することで「カンマを含まない、またはダブルクォートで囲まれていて、その中にダブルクォートを含まない文字列」というフィールドパターンを定義しています.</p>

<table>
  <thead>
    <tr>
      <th>正規表現</th>
      <th>意味</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">[^...]</code></td>
      <td>角括弧に含まれる文字以外にマッチ</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">+</code></td>
      <td>直前の文字が １回以上 繰り返す場合にマッチ<br />最長一致, 条件に合う最長の部分に一致</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">|</code></td>
      <td>OR条件</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>REMARKS</p>
</blockquote>

<ul>
  <li><code class="language-plaintext highlighter-rouge">FPAT</code>を渡す場合は、<code class="language-plaintext highlighter-rouge">-F</code> のセパレーター指定してはいけない</li>
  <li>二重クォートでエスケープされたレコードは<code class="language-plaintext highlighter-rouge">FPAT='([^,]+)|(\"[^\"]+\")'</code>で対応することができません</li>
</ul>

<h2 id="markdownファイルの編集に役に立つawkコマンドの紹介">Markdownファイルの編集に役に立つawkコマンドの紹介</h2>
<h3 id="順序付きリストの整形">順序付きリストの整形</h3>

<blockquote>
  <p>問題</p>
</blockquote>

<p>Markdownでは、行頭が数字とドットとspaceではじまる行は順序付きリストと呼ばれ、何かのリストを各項目別に番号を振って列挙する際によく使用されます.
いま以下のように, <code class="language-plaintext highlighter-rouge">item.md</code>が与えられたとします:</p>

<div class="language-md highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="gh"># AAA</span>
<span class="p">
1.</span> fasukdhals
<span class="p">1.</span> jhdlasjhdkla
<span class="p">1.</span> 1jakl;dj;asld;l1.17638

<span class="gh"># BBB</span>
<span class="p">
7.</span> 86789132789
<span class="p">9.</span> slikrujdhklsjfkljsljf
<span class="p">10.</span> ksfhdljksdhfhsdlj
</pre></td></tr></tbody></table></code></pre></div></div>

<p>これは順番通りになっていないので、行の位置は変えずに、行頭の数字を振り直し、<code class="language-plaintext highlighter-rouge">item_fixed.md</code>を作成したいとします. つまり、<code class="language-plaintext highlighter-rouge">item_fixed.md</code>の中身は</p>

<div class="language-md highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="gh"># AAA</span>
<span class="p">
1.</span> fasukdhals
<span class="p">2.</span> jhdlasjhdkla
<span class="p">3.</span> 1jakl;dj;asld;l1.17638

<span class="gh"># BBB</span>
<span class="p">
1.</span> 86789132789
<span class="p">2.</span> slikrujdhklsjfkljsljf
<span class="p">3.</span> ksfhdljksdhfhsdlj
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>解答</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">cat </span>item.md|awk <span class="s1">'/^[0-9]+\.\s/{a++;$1=a".";print}/^#/{a=0}!/^[0-9]+\./'</span> <span class="o">&gt;</span> item_fixed.md
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>解説</p>
</blockquote>

<ul>
  <li><code class="language-plaintext highlighter-rouge">awk '/正規表現/'</code>は<code class="language-plaintext highlighter-rouge">grep 正規表現</code>と同じ挙動</li>
  <li><code class="language-plaintext highlighter-rouge">'/^[0-9]+\.\s/</code>, <code class="language-plaintext highlighter-rouge">/^#/</code>, <code class="language-plaintext highlighter-rouge">!/^[0-9]+\./'</code>の３つのルールを指定
    <ul>
      <li><code class="language-plaintext highlighter-rouge">'/^[0-9]+\./</code>: 行頭が数字, ドット, spaceで始まる行を抽出</li>
      <li><code class="language-plaintext highlighter-rouge">/^#/</code>: 行頭がシャープから始まる行を抽出</li>
      <li><code class="language-plaintext highlighter-rouge">!/^[0-9]+\./'</code>: 行頭が数字, ドット, spaceで始まらない行を抽出</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">/^#/{a=0}</code>: 見出しマークを目印に<code class="language-plaintext highlighter-rouge">a</code>の値をリセット</li>
</ul>

<h2 id="references">References</h2>

<ul>
  <li><a href="https://gihyo.jp/book/2021/978-4-297-12267-6">1日1問、半年以内に習得 シェル・ワンライナー160本ノック</a></li>
  <li><a href="https://www.tohoho-web.com/ex/awk.html">とほほのAWK入門</a></li>
  <li><a href="https://codezine.jp/article/detail/7852">「シェル芸」に効く AWK処方箋　第3回</a></li>
  <li><a href="https://future-architect.github.io/articles/20210330/">CSVと親しくなるAWK術</a></li>
  <li><a href="http://jinbei.s58.xrea.com/data_ability.htm">スタンドパラメータ - 甚平 - ジョジョの奇妙な冒険</a></li>
  <li><a href="https://unix.stackexchange.com/questions/208440/create-directory-and-files-from-csv-file">StackExchange&gt;Create directory and files from csv file</a></li>
</ul>


                <hr style="visibility: hidden;">
                <hr/>
                <b><fontsize="5">Share Buttons</font><br></b>
                <!--see 
    https://jekyllcodex.org/without-plugin/share-buttons/ 
    https://ranvir.xyz/blog/why-and-how-to-add-social-sharing-buttons-on-your-jekyll-blog-using-github-pages/
-->



<style>
#share-buttons {display: inline-block; vertical-align: middle; }
#share-buttons:after {content: ""; display: block; clear: both;}
#share-buttons > div {
    position: relative;
    text-align: left; 
    height: 36px; 
    width: 32px; 
    float: left; 
    text-align: center;
}
#share-buttons > div > svg {height: 16px; fill: #d5d5d5; margin-top: 10px;}
#share-buttons > div:hover {cursor: pointer;}
#share-buttons > div.facebook:hover > svg {fill: #3B5998;}
#share-buttons > div.twitter:hover > svg {fill: #55ACEE;}
#share-buttons > div.linkedin:hover > svg {fill: #0077b5;}
#share-buttons > div.pinterest:hover > svg {fill: #CB2027;}
#share-buttons > div.gplus:hover > svg {fill: #dd4b39;}
#share-buttons > div.mail:hover > svg {fill: #7D7D7D;}
#share-buttons > div.instagram:hover > svg {fill: #C73B92;}
#share-buttons > div.facebook > svg {height: 18px; margin-top: 9px;}
#share-buttons > div.twitter > svg {height: 20px; margin-top: 8px;}
#share-buttons > div.linkedin > svg {height: 19px; margin-top: 7px;}
#share-buttons > div.pinterest > svg {height: 20px; margin-top: 9px;}
#share-buttons > div.gplus > svg {height: 17px; margin-top: 9px; position: relative; left: 1px;}
#share-buttons > div.mail > svg {height: 14px; margin-top: 11px;}
</style>

<span style="color: black">Share on: </span><div id="share-buttons">
    <div class="facebook" title="Share this on Facebook" onclick="gtag('event', 'Facebook', {'event_category':'Post Shared','event_label':'Facebook'}); location.href='http://www.facebook.com/share.php?u=https://ryonakagami.github.io/2021/12/16/awk-command-basic/';"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759h-306v-759h-255v-296h255v-218q0-186 104-288.5t277-102.5q147 0 228 12z"/></svg></div>
    <div class="twitter" title="Share this on Twitter" onclick="gtag('event', 'Twitter', {'event_category':'Post Shared','event_label':'Twitter'}); location.href='https://twitter.com/intent/tweet?text=awkコマンドを用いた前処理の紹介&url=https://ryonakagami.github.io/2021/12/16/awk-command-basic/';"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"/></svg></div>
    <div class="linkedin" title="Share this on Linkedin" onclick="gtag('event', 'Linkedin', {'event_category':'Post Shared','event_label':'Linkedin'}); location.href='https://www.linkedin.com/shareArticle?mini=true&url=https://ryonakagami.github.io/2021/12/16/awk-command-basic/&title=&summary=&source=';"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"/></svg></div>
    
    <div class="mail" title="Share this through Email" onclick="gtag('event', 'Email', {'event_category':'Post Shared','event_label':'Email'}); location.href='mailto:?&body=https://ryonakagami.github.io/2021/12/16/awk-command-basic/';"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1792 710v794q0 66-47 113t-113 47h-1472q-66 0-113-47t-47-113v-794q44 49 101 87 362 246 497 345 57 42 92.5 65.5t94.5 48 110 24.5h2q51 0 110-24.5t94.5-48 92.5-65.5q170-123 498-345 57-39 100-87zm0-294q0 79-49 151t-122 123q-376 261-468 325-10 7-42.5 30.5t-54 38-52 32.5-57.5 27-50 9h-2q-23 0-50-9t-57.5-27-52-32.5-54-38-42.5-30.5q-91-64-262-182.5t-205-142.5q-62-42-117-115.5t-55-136.5q0-78 41.5-130t118.5-52h1472q65 0 112.5 47t47.5 113z"/></svg></div>
</div>

                
                <hr/>

                <!-- Featured Tags -->
                <b><fontsize="5">Feature Tags</b>
                    <div id="tag_cloud" class="tags tags-sup js-tags" 
                    style="line-height: 0px !important;">
                        
                        
                        
                        
                        
                                <a data-sort="0288" 
                                    href="/archive/?tag=%E7%B5%B1%E8%A8%88"
                                    title="統計"
                                    style="color: #337ab7 !important;"
                                    rel="61">統計</a>
                        
                                <a data-sort="0298" 
                                    href="/archive/?tag=Python"
                                    title="Python"
                                    style="color: #337ab7 !important;"
                                    rel="51">Python</a>
                        
                                <a data-sort="0300" 
                                    href="/archive/?tag=math"
                                    title="math"
                                    style="color: #337ab7 !important;"
                                    rel="49">math</a>
                        
                                <a data-sort="0303" 
                                    href="/archive/?tag=Linux"
                                    title="Linux"
                                    style="color: #337ab7 !important;"
                                    rel="46">Linux</a>
                        
                                <a data-sort="0316" 
                                    href="/archive/?tag=Ubuntu+20.04+LTS"
                                    title="Ubuntu 20.04 LTS"
                                    style="color: #337ab7 !important;"
                                    rel="33">Ubuntu 20.04 LTS</a>
                        
                                <a data-sort="0319" 
                                    href="/archive/?tag=Shell"
                                    title="Shell"
                                    style="color: #337ab7 !important;"
                                    rel="30">Shell</a>
                        
                                <a data-sort="0321" 
                                    href="/archive/?tag=English"
                                    title="English"
                                    style="color: #337ab7 !important;"
                                    rel="28">English</a>
                        
                                <a data-sort="0324" 
                                    href="/archive/?tag=git"
                                    title="git"
                                    style="color: #337ab7 !important;"
                                    rel="25">git</a>
                        
                                <a data-sort="0329" 
                                    href="/archive/?tag=%E6%96%B9%E6%B3%95%E8%AB%96"
                                    title="方法論"
                                    style="color: #337ab7 !important;"
                                    rel="20">方法論</a>
                        
                                <a data-sort="0333" 
                                    href="/archive/?tag=Ubuntu+22.04+LTS"
                                    title="Ubuntu 22.04 LTS"
                                    style="color: #337ab7 !important;"
                                    rel="16">Ubuntu 22.04 LTS</a>
                        
                                <a data-sort="0337" 
                                    href="/archive/?tag=%E7%B5%B1%E8%A8%88%E6%A4%9C%E5%AE%9A"
                                    title="統計検定"
                                    style="color: #337ab7 !important;"
                                    rel="12">統計検定</a>
                        
                                <a data-sort="0338" 
                                    href="/archive/?tag=%E7%AB%B6%E6%8A%80%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0"
                                    title="競技プログラミング"
                                    style="color: #337ab7 !important;"
                                    rel="11">競技プログラミング</a>
                        
                                <a data-sort="0339" 
                                    href="/archive/?tag=%E3%83%95%E3%83%BC%E3%83%AA%E3%82%A8%E8%A7%A3%E6%9E%90"
                                    title="フーリエ解析"
                                    style="color: #337ab7 !important;"
                                    rel="10">フーリエ解析</a>
                        
                                <a data-sort="0340" 
                                    href="/archive/?tag=%E5%89%8D%E5%87%A6%E7%90%86"
                                    title="前処理"
                                    style="color: #337ab7 !important;"
                                    rel="9">前処理</a>
                        
                                <a data-sort="0340" 
                                    href="/archive/?tag=SQL"
                                    title="SQL"
                                    style="color: #337ab7 !important;"
                                    rel="9">SQL</a>
                        
                                <a data-sort="0340" 
                                    href="/archive/?tag=coding"
                                    title="coding"
                                    style="color: #337ab7 !important;"
                                    rel="9">coding</a>
                        
                                <a data-sort="0341" 
                                    href="/archive/?tag=%E3%82%B3%E3%83%9F%E3%83%A5%E3%83%8B%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3"
                                    title="コミュニケーション"
                                    style="color: #337ab7 !important;"
                                    rel="8">コミュニケーション</a>
                        
                                <a data-sort="0342" 
                                    href="/archive/?tag=Network"
                                    title="Network"
                                    style="color: #337ab7 !important;"
                                    rel="7">Network</a>
                        
                                <a data-sort="0342" 
                                    href="/archive/?tag=ssh"
                                    title="ssh"
                                    style="color: #337ab7 !important;"
                                    rel="7">ssh</a>
                        
                                <a data-sort="0343" 
                                    href="/archive/?tag=%E5%B0%86%E6%A3%8B"
                                    title="将棋"
                                    style="color: #337ab7 !important;"
                                    rel="6">将棋</a>
                        
                                <a data-sort="0343" 
                                    href="/archive/?tag=Data+visualization"
                                    title="Data visualization"
                                    style="color: #337ab7 !important;"
                                    rel="6">Data visualization</a>
                        
                                <a data-sort="0343" 
                                    href="/archive/?tag=Docker"
                                    title="Docker"
                                    style="color: #337ab7 !important;"
                                    rel="6">Docker</a>
                        
                                <a data-sort="0343" 
                                    href="/archive/?tag=Econometrics"
                                    title="Econometrics"
                                    style="color: #337ab7 !important;"
                                    rel="6">Econometrics</a>
                        
                                <a data-sort="0343" 
                                    href="/archive/?tag=VSCode"
                                    title="VSCode"
                                    style="color: #337ab7 !important;"
                                    rel="6">VSCode</a>
                        
                                <a data-sort="0343" 
                                    href="/archive/?tag=statistical+inference"
                                    title="statistical inference"
                                    style="color: #337ab7 !important;"
                                    rel="6">statistical inference</a>
                        
                                <a data-sort="0344" 
                                    href="/archive/?tag=GitHub+Pages"
                                    title="GitHub Pages"
                                    style="color: #337ab7 !important;"
                                    rel="5">GitHub Pages</a>
                        
                                <a data-sort="0344" 
                                    href="/archive/?tag=apt"
                                    title="apt"
                                    style="color: #337ab7 !important;"
                                    rel="5">apt</a>
                        
                                <a data-sort="0344" 
                                    href="/archive/?tag=development"
                                    title="development"
                                    style="color: #337ab7 !important;"
                                    rel="5">development</a>
                        
                                <a data-sort="0345" 
                                    href="/archive/?tag=%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E7%AE%A1%E7%90%86"
                                    title="システム管理"
                                    style="color: #337ab7 !important;"
                                    rel="4">システム管理</a>
                        
                                <a data-sort="0345" 
                                    href="/archive/?tag=Coffee"
                                    title="Coffee"
                                    style="color: #337ab7 !important;"
                                    rel="4">Coffee</a>
                        
                                <a data-sort="0345" 
                                    href="/archive/?tag=cloud"
                                    title="cloud"
                                    style="color: #337ab7 !important;"
                                    rel="4">cloud</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=%E6%95%B0%E5%80%A4%E8%A8%88%E7%AE%97"
                                    title="数値計算"
                                    style="color: #337ab7 !important;"
                                    rel="3">数値計算</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=%E7%B4%A0%E6%95%B0"
                                    title="素数"
                                    style="color: #337ab7 !important;"
                                    rel="3">素数</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=Book"
                                    title="Book"
                                    style="color: #337ab7 !important;"
                                    rel="3">Book</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=Font"
                                    title="Font"
                                    style="color: #337ab7 !important;"
                                    rel="3">Font</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=Metrics"
                                    title="Metrics"
                                    style="color: #337ab7 !important;"
                                    rel="3">Metrics</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=Poetry"
                                    title="Poetry"
                                    style="color: #337ab7 !important;"
                                    rel="3">Poetry</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=Ubuntu+24.04+LTS"
                                    title="Ubuntu 24.04 LTS"
                                    style="color: #337ab7 !important;"
                                    rel="3">Ubuntu 24.04 LTS</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=architecture"
                                    title="architecture"
                                    style="color: #337ab7 !important;"
                                    rel="3">architecture</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=aws"
                                    title="aws"
                                    style="color: #337ab7 !important;"
                                    rel="3">aws</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=shell"
                                    title="shell"
                                    style="color: #337ab7 !important;"
                                    rel="3">shell</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=systemctl"
                                    title="systemctl"
                                    style="color: #337ab7 !important;"
                                    rel="3">systemctl</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88"
                                    title="テンプレート"
                                    style="color: #337ab7 !important;"
                                    rel="2">テンプレート</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=%E3%83%87%E3%83%BC%E3%82%BF%E6%A7%8B%E9%80%A0"
                                    title="データ構造"
                                    style="color: #337ab7 !important;"
                                    rel="2">データ構造</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=%E3%83%9D%E3%83%AF%E3%82%BD%E3%83%B3%E5%88%86%E5%B8%83"
                                    title="ポワソン分布"
                                    style="color: #337ab7 !important;"
                                    rel="2">ポワソン分布</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=%E4%BC%9A%E8%A8%88%E5%88%86%E6%9E%90"
                                    title="会計分析"
                                    style="color: #337ab7 !important;"
                                    rel="2">会計分析</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=%E6%96%87%E5%AD%97%E3%82%B3%E3%83%BC%E3%83%89"
                                    title="文字コード"
                                    style="color: #337ab7 !important;"
                                    rel="2">文字コード</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89"
                                    title="環境構築"
                                    style="color: #337ab7 !important;"
                                    rel="2">環境構築</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=%E8%AB%96%E6%96%87"
                                    title="論文"
                                    style="color: #337ab7 !important;"
                                    rel="2">論文</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=App"
                                    title="App"
                                    style="color: #337ab7 !important;"
                                    rel="2">App</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=Bayesian"
                                    title="Bayesian"
                                    style="color: #337ab7 !important;"
                                    rel="2">Bayesian</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=Dynamic+Programming"
                                    title="Dynamic Programming"
                                    style="color: #337ab7 !important;"
                                    rel="2">Dynamic Programming</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=Keyboard"
                                    title="Keyboard"
                                    style="color: #337ab7 !important;"
                                    rel="2">Keyboard</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=Processing"
                                    title="Processing"
                                    style="color: #337ab7 !important;"
                                    rel="2">Processing</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=R"
                                    title="R"
                                    style="color: #337ab7 !important;"
                                    rel="2">R</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=Steam"
                                    title="Steam"
                                    style="color: #337ab7 !important;"
                                    rel="2">Steam</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=filesystem"
                                    title="filesystem"
                                    style="color: #337ab7 !important;"
                                    rel="2">filesystem</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=quarto"
                                    title="quarto"
                                    style="color: #337ab7 !important;"
                                    rel="2">quarto</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=regex"
                                    title="regex"
                                    style="color: #337ab7 !important;"
                                    rel="2">regex</a>
                    </div>

                <br>

                <b><fontsize="5">Leave a Comment</font><br>(注意：GitHub Accountが必要となります）</b>
                
                <script src="https://utteranc.es/client.js"
                    repo="RyoNakagami/RyoNakagami.github.io"
                    issue-term="url"
                    theme="github-light"
                    crossorigin="anonymous"
                    async>Reduce unused JavaScript
                
                </script>


            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-1 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog fixed" style="margin-top:3%">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CONTENTS</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        
    <!-- Sidebar Container -->
            <!-- <div class="
                col-lg-10 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container row"> -->
                <!-- 
<hr>
<h5>FRIENDS</h5>
<ul class="list-inline">
  
  <li><a href="https://twitter.com/bluesky0804?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor">bluesky0804</a></li>
  
</ul>

 -->
            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->

  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" id="MathJax-script"></script>
<script>
  MathJax = {
    tex: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\\[','\\]']],
      processEscapes: true,
      processEnvironments: true, // for pseudo
      tags: "ams",
      autoload: {
        color: [],
        colorV2: ['color']
      },
      packages: {'[+]': ['noerrors']}
    },
    chtml: {
      matchFontHeight: false,
      displayAlign: "left",
      displayIndent: "2em"
    },
    options: {
      renderActions: {
        /* add a new named action to render <script type="math/tex"> */
        find_script_mathtex: [10, function (doc) {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/);
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
            const text = document.createTextNode('');
            node.parentNode.replaceChild(text, node);
            math.start = {node: text, delim: '', n: 0};
            math.end = {node: text, delim: '', n: 0};
            doc.math.push(math);
          }
        }, '']
      }
    },
    loader: {
      load: ['[tex]/noerrors']
    }
  };
</script>





<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'right',
          // icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>


<body>
    <!-- enable mermaid language on markdown post -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
<script>
   mermaid.initialize({
       startOnLoad:true,
       theme: 'default'
   });
   window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
</script>

</body>

    <script>
    
    var elements = document.querySelectorAll('p');
    Array.prototype.forEach.call(elements, function(el, i){
        if(el.innerHTML=='[expand]') {
            var parentcontent = el.parentNode.innerHTML.replace('<p>[expand]</p>','<div class="expand" style="display: none; height: 0; overflow: hidden;">').replace('<p>[/expand]</p>','</div>');
            el.parentNode.innerHTML = parentcontent;
        }
    });

    var elements = document.querySelectorAll('div.expand');
    Array.prototype.forEach.call(elements, function(el, i){
        el.previousElementSibling.innerHTML = el.previousElementSibling.innerHTML + '<span>..&nbsp; <a href="#" style="cursor: pointer;" onclick="this.parentNode.parentNode.nextElementSibling.style.display = \'block\'; this.parentNode.parentNode.nextElementSibling.style.height = \'auto\'; this.parentNode.style.display = \'none\';">read&nbsp;more&nbsp;&rarr;</a></span>';
    });

</script>

    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <!--<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"> -->
                <!-- SNS Link -->
            


<ul class="list-inline text-center">


  
  
  
  
  <li>
    <a target="_blank" href="https://github.com/RyoNakagami">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
</ul>

            
            <p class="copyright text-muted">
                Copyright &copy; Ryo's Tech Blog 2025
                <br>
                Powered by <a href="https://ryonakagami.github.io">Ryo's Tech Blog</a> |
                <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="100px"
                    height="20px"
                    title="RyoNakagami.github.io github stars"
                    src="https://ghbtns.com/github-btn.html?user=RyoNakagami&repo=RyoNakagami.github.io&type=star&count=true">
                </iframe>
            </p>
            <!--</div> -->
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/ryo-blog.min.js "></script>

<!-- Simple Jekyll Search -->
<script src="/js/simple-jekyll-search.min.js"></script>

<!-- Service Worker -->

<script src="/js/snackbar.js "></script>
<script src="/js/sw-registration.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->







<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LVL413SV09"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-LVL413SV09');
</script>



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog(selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->


<!-- Simple Jekyll Search -->
<script>
    // https://stackoverflow.com/questions/1912501/unescape-html-entities-in-javascript
    function htmlDecode(input) {
        var e = document.createElement('textarea');
        e.innerHTML = input;
        // handle case of empty input
        return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
    }

    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('search-results'),
        json: '/search.json',
        searchResultTemplate: '<div class="post-preview item"><a href="{url}"><h2 class="post-title">{title}</h2><h3 class="post-subtitle">{subtitle}</h3><hr></a></div>',
        noResultsText: 'No results',
        limit: 50,
        fuzzy: false,
        // a hack to get escaped subtitle unescaped. for some reason, 
        // post.subtitle w/o escape filter nuke entire search.
        templateMiddleware: function (prop, value, template) {
            if (prop === 'subtitle' || prop === 'title') {
                if (value.indexOf("code")) {
                    return htmlDecode(value);
                } else {
                    return value;
                }
            }
        }
    });

    $(document).ready(function () {
        var $searchPage = $('.search-page');
        var $searchOpen = $('.search-icon');
        var $searchClose = $('.search-icon-close');
        var $searchInput = $('#search-input');
        var $body = $('body');

        $searchOpen.on('click', function (e) {
            e.preventDefault();
            $searchPage.toggleClass('search-active');
            var prevClasses = $body.attr('class') || '';
            setTimeout(function () {
                $body.addClass('no-scroll');
            }, 400)

            if ($searchPage.hasClass('search-active')) {
                $searchClose.on('click', function (e) {
                    e.preventDefault();
                    $searchPage.removeClass('search-active');
                    $body.attr('class', prevClasses);  // from closure 
                });
                $searchInput.focus();
            }
        });
    });
</script>



<!-- Image to Github 
<img src="/img/icon_wechat.png" width="0" height="0" />
<-- Migrate from head to bottom, no longer block render and still work -->
<script>
    
    var elements = document.querySelectorAll('p');
    Array.prototype.forEach.call(elements, function(el, i){
        if(el.innerHTML=='[expand]') {
            var parentcontent = el.parentNode.innerHTML.replace('<p>[expand]</p>','<div class="expand" style="display: none; height: 0; overflow: hidden;">').replace('<p>[/expand]</p>','</div>');
            el.parentNode.innerHTML = parentcontent;
        }
    });

    var elements = document.querySelectorAll('div.expand');
    Array.prototype.forEach.call(elements, function(el, i){
        el.previousElementSibling.innerHTML = el.previousElementSibling.innerHTML + '<span>..&nbsp; <a href="#" style="cursor: pointer;" onclick="this.parentNode.parentNode.nextElementSibling.style.display = \'block\'; this.parentNode.parentNode.nextElementSibling.style.height = \'auto\'; this.parentNode.style.display = \'none\';">read&nbsp;more&nbsp;&rarr;</a></span>';
    });

</script>

</body>
</html>
