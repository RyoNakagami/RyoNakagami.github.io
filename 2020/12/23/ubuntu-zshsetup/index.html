<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="gSMaswRY9iRfG4QaQrx6aj481bgr503qEZh-QPsMYNU" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="元経済学徒, 現在どっかでデータサイエンティストもどきやってる人間の勉強日記">
    <meta name="keywords"  content="Statistics, Economics, Econometrics, Python, C, Shell, Linux, Data scientist">
    <meta name="theme-color" content="#000000">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Z shell installation and configuration - Ryo's Tech Blog">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="


">
    
    <meta property="article:published_time" content="2020-12-23T00:00:00Z">
    
    
    <meta property="article:author" content="Ryo">
    
    
    <meta property="article:tag" content="Ubuntu 20.04 LTS">
    
    <meta property="article:tag" content="Ubuntu 22.04 LTS">
    
    <meta property="article:tag" content="Shell">
    
    
    <meta property="og:image" content="https://ryonakagami.github.io/img/avatar_rio_cat.jpg">
    <meta property="og:url" content="https://ryonakagami.github.io/2020/12/23/ubuntu-zshsetup/">
    <meta property="og:site_name" content="Ryo's Tech Blog">
    
    <title>Z shell installation and configuration - Ryo's Tech Blog</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://ryonakagami.github.io/2020/12/23/ubuntu-zshsetup/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/ryo-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- https://stackoverflow.com/questions/45983301/google-pagespeed-eliminate-render-blocking-resources-above-the-fold-caused-fro -->
    <!--link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"-->
    <!--<link href="https://fonts.googleapis.com/earlyaccess/notosansjapanese.css" rel="stylesheet" type="text/css" media="print" onload="this.media='all'" > -->
    <link href="https://fonts.googleapis.com/earlyaccess/notosansjapanese.css" rel="preload" type="text/css" media="print" onload="this.media='all'" >


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->

<nav class="navbar navbar-default navbar-custom navbar-fixed-top invert">
    
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Ryo's Tech Blog</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div id="huxblog_navbar">
                <div class="navbar-collapse">
                    <ul class="nav navbar-nav navbar-left">
                                                <li>
                            <a href="https://ryonakagami.github.io/statistics-for-regression-monkey/">Statistics for
                                Regression Monkeys</a>
                        </li>
                        <li>
                            <a href="https://ohgoshgit.github.io/">OhGoshGit!?!</a>
                        </li>
                        <!-- <li>
                            <a><button onclick="mainDropDown()" style="border-color: rgba(70, 83, 111, 0.989); background-color: rgba(70, 83, 111, 0.989)">Dropdown</button></a> 
                            <div id="myDropdown" class="dropdown-content">
                              <a href="#" onclick="subMenu(this)">A</a>
                              <div class="sub-menu-item" id="subMenu1">
                              <a href="#">A.1</a>
                              </div>
                              <a href="#" onclick="subMenu(this)">B</a>
                              <div class="sub-menu-item" id="subMenu2">
                              <a href="#">B.1</a>
                              </div>
                              <a href="#">C</a>
                              <a href="#">D</a>
                              <a href="#">E</a>
                              <a href="#">F</a>
                              <a href="#">G</a>
                            </div>
                        </li> -->
                    </ul>
                    </ul>
                    <ul class="nav navbar-nav navbar-right">
                        
                        
                        
                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                        
                        
                        <li>
                            <a href="/archive/">Tag Search</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <!--about fa-search see https://stackoverflow.com/questions/41950677/how-to-make-my-search-icon-fixed-->
                        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
                            rel="stylesheet" />
                        <li class="search-icon">
                            <a href="javascript:void(0)" aria-label="Search" target="_blank">
                                <i class="fa fa-search"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <script>
        // Drop Bootstarp low-performance Navbar
        // Use customize navbar with high-quality material design animation
        // in high-perf jank-free CSS3 implementation
        var $body = document.body;
        var $toggle = document.querySelector('.navbar-toggle');
        var $navbar = document.querySelector('#huxblog_navbar');
        var $collapse = document.querySelector('.navbar-collapse');

        var __HuxNav__ = {
            close: function () {
                $navbar.className = " ";
                // wait until animation end.
                setTimeout(function () {
                    // prevent frequently toggle
                    if ($navbar.className.indexOf('in') < 0) {
                        $collapse.style.height = "0px"
                    }
                }, 400)
            },
            open: function () {
                $collapse.style.height = "auto"
                $navbar.className += " in";
            }
        }

        // Bind Event
        $toggle.addEventListener('click', function (e) {
            if ($navbar.className.indexOf('in') > 0) {
                __HuxNav__.close()
            } else {
                __HuxNav__.open()
            }
        })

        /**
         * Since Fastclick is used to delegate 'touchstart' globally
         * to hack 300ms delay in iOS by performing a fake 'click',
         * Using 'e.stopPropagation' to stop 'touchstart' event from 
         * $toggle/$collapse will break global delegation.
         * 
         * Instead, we use a 'e.target' filter to prevent handler
         * added to document close HuxNav.  
         *
         * Also, we use 'click' instead of 'touchstart' as compromise
         */
        document.addEventListener('click', function (e) {
            if (e.target == $toggle) return;
            if (e.target.className == 'icon-bar') return;
            __HuxNav__.close();
        })
    </script>

    <!-- Search -->
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/home-bg.jpg" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/home-bg.jpg');
        background: ;
    }

    
    header.intro-header .header-mask{
        width: 100%;
        height: 100%;
        position: absolute;
        background: rgba(0,0,0, 0.0);
    }
    
</style>




<header class="intro-header style-text" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/archive/?tag=Ubuntu+20.04+LTS" title="Ubuntu 20.04 LTS">Ubuntu 20.04 LTS</a>
                        
                        <a class="tag" href="/archive/?tag=Ubuntu+22.04+LTS" title="Ubuntu 22.04 LTS">Ubuntu 22.04 LTS</a>
                        
                        <a class="tag" href="/archive/?tag=Shell" title="Shell">Shell</a>
                        
                    </div>
                    <h1>Z shell installation and configuration</h1>
                    
                    <h2 class="subheading">Shell Environement Set-up 2/N</h2>
                    <p>
                        公開日: 2020-12-23
                        <br>
                        更新日: 2024-04-23
                        
                    </p>
                </div>
            </div>
        </div>
    </div>
</header>







<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
         <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<div style="border-radius: 1em; border-style:solid; border-color:#D3D3D3; background-color:#F8F8F8">

  <p class="h4">  Table of Contents</p>

  <!-- START doctoc generated TOC please keep comment here to allow auto update -->
  <!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#what-is-z-shellzsh-">What is Z Shell(=zsh) ?</a>
      <ul>
        <li><a href="#shell-and-kernel">Shell and Kernel</a></li>
        <li><a href="#z-shell-better-than-bash">Z shell: better than Bash?</a>
          <ul>
            <li><a href="#%E8%A8%AD%E5%AE%9A%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E7%A8%AE%E9%A1%9E">設定ファイルの種類</a></li>
            <li><a href="#%E8%A8%AD%E5%AE%9A%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8C%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BE%E3%82%8C%E3%82%8B%E3%82%BF%E3%82%A4%E3%83%9F%E3%83%B3%E3%82%B0">設定ファイルが読み込まれるタイミング</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#installing-zsh">Installing Zsh</a></li>
    <li><a href="#configuration">Configuration</a>
      <ul>
        <li><a href="#%E5%9F%BA%E6%9C%AC%E6%96%B9%E9%87%9D">基本方針</a></li>
        <li><a href="#zshrc%E3%81%AE%E8%A8%AD%E5%AE%9A"><code class="language-plaintext highlighter-rouge">.zshrc</code>の設定</a>
          <ul>
            <li><a href="#1-%E3%83%92%E3%82%B9%E3%83%88%E3%83%AA%E3%83%BC%E3%82%B5%E3%82%A4%E3%82%BA%E3%81%AE%E5%86%8D%E8%A8%AD%E5%AE%9A">(1) ヒストリーサイズの再設定</a></li>
            <li><a href="#2-zsh%E3%81%AEgit-command%E8%A3%9C%E5%AE%8C%E3%82%92%E6%9C%89%E5%8A%B9%E3%81%AB%E3%81%99%E3%82%8B">(2) Zshのgit command補完を有効にする</a></li>
            <li><a href="#3-git-posh-like-git-prompt">(3) git-posh like git prompt</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#appendix">Appendix</a>
      <ul>
        <li><a href="#chsh%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89">chshコマンド</a></li>
        <li><a href="#path%E3%81%AE%E8%A8%AD%E5%AE%9A">PATHの設定</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>

  <!-- END doctoc generated TOC please keep comment here to allow auto update -->

</div>

<h2 id="overview">Overview</h2>

<p><strong>想定環境</strong></p>

<table>
  <thead>
    <tr>
      <th>OS</th>
      <th>CPU</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Ubuntu 20.04 LTS</td>
      <td>Intel Core i7-9700 CPU 3.00 GHz</td>
    </tr>
    <tr>
      <td>Ubuntu 22.04.2 LTS</td>
      <td>AMD Ryzen 9 7950X 16-Core Processor</td>
    </tr>
  </tbody>
</table>

<p><strong>What Did I Do?</strong></p>

<ul>
  <li>zshのinstall</li>
  <li><code class="language-plaintext highlighter-rouge">~/.zshenv</code>, <code class="language-plaintext highlighter-rouge">~/.zshrc</code>の設定
    <ul>
      <li>command補完機能の有効化</li>
      <li>git branch statusを表示するPromptの設定</li>
      <li>alias, 自作コマンドの読み込み</li>
    </ul>
  </li>
</ul>

<h2 id="what-is-z-shellzsh-">What is Z Shell(=zsh) ?</h2>

<p>Z shell(= zsh)はシェルの一種で, bashやtcsh, kshの機能を取り入れる形でBourneシェルを改良したシェルのことです.
zsh以外の代表的なシェルは以下です:</p>

<table>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">sh</code></td>
      <td>Bourne-shell. 動作は高速だが機能が貧弱という特徴がある. b-shellとも呼ばれる.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">bash</code></td>
      <td>Bourne-shellを大幅に改良したBourne Again SHell. Linuxでは標準シェルとして採用されている. 基本どこでも使えるシェルなので, シェルスクリプトは原則bashで記述するのが望ましい.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">csh</code></td>
      <td>DSD系UNIXで使われたシェル. C言語風のコマンド構文を持っているのが特徴.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">tcsh</code></td>
      <td>cshを改良したシェル</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ash</code></td>
      <td>shの代替となる,小型かつ高速なシェル.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">dash</code></td>
      <td>Debian版ash. 動作が軽量高速という特徴がある. <code class="language-plaintext highlighter-rouge">/bin/sh</code>はシンボリックリンク.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ksh</code></td>
      <td>Korn-shell. bシェルを拡張したシェル. bashのバイナリよりも小さく, 多くの関数（<code class="language-plaintext highlighter-rouge">echo</code>や<code class="language-plaintext highlighter-rouge">getopts</code>など）が個別の実行ファイルではなくシェルの中に組み込まれていて, メモリ効率性の観点から実行スピードが速い特徴がある.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">zsh</code></td>
      <td>b-shellを拡張したシェル. bashやtcshの機能を取り入れた強力なシェル. 補完機能やプロンプトカスタムなどユーザーフレンドリーなシェル.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">fish</code></td>
      <td>fish-shell. 2005年にリリースされた比較的新しいユーザーフレンドリーなシェル.</td>
    </tr>
  </tbody>
</table>

<h3 id="shell-and-kernel">Shell and Kernel</h3>

<p>シェルは一言で言えば, 「<strong>ユーザーの命令をカーネルに伝えるための道具</strong>」です. 
このことを理解するためには, コンピューターの動作を管理しているOSの頭脳ともいうべき「<strong>カーネル</strong>」という概念をまず理解する必要があります.</p>

<div style="padding-left: 2em; padding-right: 2em; border-radius: 1em; border-style:solid; border-color:#D3D3D3; background-color:#F8F8F8">
  <p class="h4"><ins>Def: Kernel </ins></p>

  <ul>
    <li>カーネルとはOSの核になる部分のこと</li>
    <li>カーネルプログラムによってコンピューターを構成するハードウェアとソフトウェアが管理されている</li>
    <li>OSによって異なるが, 実際にカーネルが担当する機能の例として Process Scheduling, Memory ManagementやSystem Callsがある</li>
  </ul>

  <p><img src="https://github.com/ryonakimageserver/omorikaizuka/blob/master/%E3%83%96%E3%83%AD%E3%82%B0%E7%94%A8/20201223-Linux-kernel-image.png?raw=true" /></p>

  <p>現在利用しているカーネルプログラムは <code class="language-plaintext highlighter-rouge">/boot/vmlinuz</code> がそのファイルとなるが, これは実際に利用しているカーネルプログラムに対するシンボリックリンクの形で存在してる:</p>

  <div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>% <span class="nb">ls</span> <span class="nt">-l</span> /boot/vmlinuz
lrwxrwxrwx 1 root root 25 Jul 25 16:50 /boot/vmlinuz -&gt; vmlinuz-5.19.0-50-generic
</pre></td></tr></tbody></table></code></pre></div>  </div>

</div>

<p>現在使用しているカーネルのバージョンを確認するには以下のいずれかのコマンドで確認できます:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>% <span class="nb">cat</span> /proc/version   
Linux version 5.4.0-58-generic <span class="o">(</span>buildd@lcy01-amd64-004<span class="o">)</span> <span class="o">(</span>gcc version 9.3.0 <span class="o">(</span>Ubuntu 9.3.0-17ubuntu1~20.04<span class="o">))</span> <span class="c">#64-Ubuntu SMP Wed Dec 9 08:16:25 UTC 2020</span>

% <span class="nb">uname</span> <span class="nt">-sr</span>        
Linux 5.4.0-58-generic
</pre></td></tr></tbody></table></code></pre></div></div>

<p>上の例を見るとわかりますが, 「Linux」とはOS自体を指す言葉ではなく本来はLinux Kernelのようにカーネルの種類を指す名称です.
このLinux Kernelに, ライブラリ, シェル, GNUソフト, GUIシステムといったカーネル以外の機能を加え, １つのOSとして配布されているものが「Linuxディストリビューション」です.
普段の用語的には, 「Linux」という名称は, Linuxディストリビューションのことを指す場合が現在では多いです.</p>

<p>続いてシェルについて説明します.</p>

<p>上で説明したカーネルはハードウェアと密接に関連しており, ユーザーの命令が機械語で書かれない限り, その命令を直接理解する能力がありません. 
ユーザーからカーネルへ命令を伝える際の窓口として機能しているのがシェルです.</p>

<div style="padding-left: 2em; padding-right: 2em; border-radius: 1em; border-style:solid; border-color:#D3D3D3; background-color:#F8F8F8">
  <p class="h4"><ins>Def: Shell</ins></p>

  <ul>
    <li>ユーザーがOSとやり取りするためのインターフェスを提供するソフトウェアがシェル</li>
    <li>ユーザーからテキストベースコマンドを受け取り, それを機械語に翻訳した上でカーネルに実行させる機能を持っているのでcommand-line interpreterの一種と認識してもよい</li>
    <li>種子の内部の核=カーネルに対して, 種子の殻=シェルから名付けられている.</li>
  </ul>

</div>

<p>ユーザーはシェルを用いることで以下のようなフローでKernelとのやり取りをすることができる:</p>

<pre><code class="language-mermaid">sequenceDiagram
    Actor A as User
    participant B as Shell
    participant C as Kernel
    
    B-&gt;&gt; A: (1) プロンプトを表示
    A-&gt;&gt; B: (2) コマンドを入力
    B--&gt;&gt;B: (3) カーネルが解釈できる命令へ翻訳
    B-&gt;&gt; C: (4) 命令を機械語で伝える
    C--&gt;&gt;C: (5) 命令を実行
    C-&gt;&gt; A: (6) 実行結果を表示
    C-&gt;&gt; B: (7) 実行終了
    B-&gt;&gt; A: (8) プロンプトを表示
</code></pre>

<p>プロンプトとはbashならば<code class="language-plaintext highlighter-rouge">$</code>, zshならば<code class="language-plaintext highlighter-rouge">%</code>とコマンドラインに表示される記号のことです.
システムがコマンドの入力を待っている状態であることを示すために, シェルがプロンプトを表示してくれています.</p>

<p>もちろん気に食わなかったらユーザーの方で設定ファイルを修正することで, プロンプトを非表示に変更することも可能です.</p>

<h3 id="z-shell-better-than-bash">Z shell: better than Bash?</h3>

<ul>
  <li>Command-lineでの強力な補完機能</li>
  <li>実行履歴をすべてのシェルで共有できる</li>
  <li>ユーザーフレンドリーな変数と配列操作</li>
  <li>named directoryを扱うことができる</li>
  <li>login shellとnot login shell両方に共通に読まれる設定ファイル<code class="language-plaintext highlighter-rouge">/etc/zshenv</code>と<code class="language-plaintext highlighter-rouge">~/.zshenv</code>がある</li>
  <li>Oh My Zshのような強力なPlug-inがある</li>
</ul>

<p>named directory機能の例：</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>login_username@host_name ~ % test=~/Desktop
login_username@host_name ~ % cd ~test      
login_username@host_name ~test
 % pwd
/home/login_username/Desktop
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="設定ファイルの種類">設定ファイルの種類</h4>

<table>
  <thead>
    <tr>
      <th>File</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">.zshenv</code></td>
      <td>Usually run for every zsh</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">.zprofile</code></td>
      <td>Run for login shells</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">.zshrc</code></td>
      <td>Run for interactive shells</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">.zlogin</code></td>
      <td>Run for login shells. 役割は <code class="language-plaintext highlighter-rouge">.zprofile</code> とほぼ一緒．<br />混乱を避けるため併用しないこと</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">.zlogout</code></td>
      <td>Run for login shells</td>
    </tr>
  </tbody>
</table>

<p>それぞれのファイルは <code class="language-plaintext highlighter-rouge">/etc/</code>, <code class="language-plaintext highlighter-rouge">~/</code>の２つのクラスがあります.
<code class="language-plaintext highlighter-rouge">/etc/</code>クラスはthe system administratorによって設定され, すべてのユーザーに対して実行されます.
各ユーザーが独自に設定したい場合は<code class="language-plaintext highlighter-rouge">~/</code>クラスのファイルを編集します.</p>

<h4 id="設定ファイルが読み込まれるタイミング">設定ファイルが読み込まれるタイミング</h4>

<p>login shellとnon-login shellの違いについては別記事でまとめる予定ですが, ユーザーがConfiguration関係で意識すべき違いは以下のフローとなります:</p>

<pre><code class="language-mermaid">graph LR
    A[Interative&lt;br&gt;Login Shell] --&gt; B[read .zshenv]
    B--&gt; C[read .zprofile]
    C--&gt; D[read .zshrc]
    D--&gt; E[read .zlogin]

    A1[Non-Interative&lt;br&gt;Login Shell] --&gt; B1[read .zshenv]
    B1--&gt; C1[read .zprofile]
    C1--&gt; D1[read .zlogin]

    A2[Interative&lt;br&gt;Non-login Shell] --&gt; B2[read .zshenv]
    B2--&gt; C2[read .zshrc]
</code></pre>

<h2 id="installing-zsh">Installing Zsh</h2>

<p>zshのインストールはapt package manager経由で簡単に取得できます.
インストールの前にpackage情報を確認してみます:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="c"># 2023-07-27に実施</span>
<span class="nv">$ </span>apt-cache show zsh
apt-cache show zsh
Package: zsh
Architecture: amd64
Version: 5.8.1-1
Priority: optional
Section: shells
...
</pre></td></tr></tbody></table></code></pre></div></div>

<p><a href="https://zsh.sourceforge.io/News/">Z Shell公式ページ</a>を確認してみると
2022-05-14に5.9がReleaseされているので, ちょっと古いZ shellであることがわかります.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>$ sudo apt install zsh
$ zsh --version
zsh 5.8 (x86_64-ubuntu-linux-gnu)
</pre></td></tr></tbody></table></code></pre></div></div>

<p>次にzshをdefault login shellとして設定します.
default login shellを変更するとinterative non-login shellのデフォルトも同時に変更されます.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>chsh <span class="nt">-s</span> <span class="si">$(</span>which zsh<span class="si">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>シェルが変更されたかどうかを確認したい場合は</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>% echo $SHELL
/usr/bin/zsh
</pre></td></tr></tbody></table></code></pre></div></div>

<p>と表示されれば問題ありません.
その後, <code class="language-plaintext highlighter-rouge">reboot</code> としてシェルが実際に変更されているか確認してください.</p>

<h2 id="configuration">Configuration</h2>
<h3 id="基本方針">基本方針</h3>

<p>zshの設定に関する設定ファイルは, Home Directory直下に存在する <code class="language-plaintext highlighter-rouge">.zshenv</code>, <code class="language-plaintext highlighter-rouge">.zprofile</code>, <code class="language-plaintext highlighter-rouge">.zshrc</code>が代表的なファイルです.
普段使うshellはnon-login shellなので基本的には<code class="language-plaintext highlighter-rouge">~/.zshenv</code>と<code class="language-plaintext highlighter-rouge">~/.zshrc</code>の２つの設定で十分です.</p>

<table>
  <thead>
    <tr>
      <th>File</th>
      <th>設定方針</th>
      <th>例</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">~/.zshenv</code></td>
      <td>login, non-login, non-interactiveに共通して読み込ませたい場合</td>
      <td>PATHの設定</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">~/.zshrc</code></td>
      <td>ユーザー目線であったら嬉しい設定を記載</td>
      <td>aliasの設定, prompt customize</td>
    </tr>
  </tbody>
</table>

<p>zsh configurationに関するファイル管理の観点から以下のような構成にします:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>~
├── .zshrc                       # Promptやaliasの設定
├── .zshenv                      # PATH関連の設定
└── .zsh.d                       # zsh関連のファイル置き場.
       ├── bin                   # 自作設定ファイル置き場
       |    ├── git-prompt.sh    # git prommpt設定
       |    └── util_function.sh # zsh専用shell-script
       ├── .zsh_history          # history file
       ├── zshrc.bak             # backup file
       └── zshenv.bak            # backup file
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="zshrcの設定"><code class="language-plaintext highlighter-rouge">.zshrc</code>の設定</h3>

<div style="padding-left: 2em; padding-right: 2em; border-radius: 1em; border-style:solid; border-color:#D3D3D3; background-color:#F8F8F8">
  <p class="h4"><ins>設定概要</ins></p>

  <ol>
    <li>ヒストリーサイズの再設定</li>
    <li>Zshのgit command補完を有効にする</li>
    <li>apt package suggest機能を有効にする</li>
    <li>git branch statusを<code class="language-plaintext highlighter-rouge">posh-git</code> likeに表示</li>
    <li><code class="language-plaintext highlighter-rouge">ls</code>や<code class="language-plaintext highlighter-rouge">grep</code>コマンドを実行した結果で表示される項目のうち,ディレクトリやシンボリックリンクファイルの場合,色や記号が付与されるようにする</li>
  </ol>

</div>

<p>2023-07時点で設定した<code class="language-plaintext highlighter-rouge">.zshrc</code>は以下:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
</pre></td><td class="rouge-code"><pre><span class="c"># -----------------------------</span>
<span class="c"># General</span>
<span class="c"># -----------------------------</span>
<span class="c"># clear settings</span>
<span class="nb">unalias</span> <span class="nt">-a</span>

<span class="c"># umask</span>
<span class="nb">umask </span>022

<span class="c"># autoload</span>
autoload <span class="nt">-Uz</span> promptinit 

<span class="c"># Set up the prompt</span>
promptinit

<span class="c"># -----------------------------</span>
<span class="c"># Sensitive</span>
<span class="c"># -----------------------------</span>
<span class="c"># GPG key setting</span>
<span class="nb">export </span><span class="nv">GPG_TTY</span><span class="o">=</span><span class="si">$(</span><span class="nb">tty</span><span class="si">)</span>


<span class="c"># -----------------------------</span>
<span class="c"># History</span>
<span class="c"># -----------------------------</span>
<span class="nv">HISTSIZE</span><span class="o">=</span>1000
<span class="nv">SAVEHIST</span><span class="o">=</span>1000000
<span class="nv">HISTFILE</span><span class="o">=</span>~/.zsh.d/.zsh_history
setopt extended_history <span class="c"># record shitory with timestamp</span>
setopt hist_ignore_space
setopt inc_append_history
setopt share_history <span class="c"># share history between terminals</span>


<span class="c"># -----------------------------</span>
<span class="c"># PATH</span>
<span class="c"># -----------------------------</span>
<span class="c"># drop path duplicate</span>
<span class="nb">typeset</span> <span class="nt">-U</span> path PATH

<span class="c"># general</span>
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/bin:</span><span class="nv">$PATH</span><span class="s2">"</span>

<span class="c"># zsh completion</span>
fpath+<span class="o">=</span>~/.zsh.d/.zfunc

<span class="c">#-------------------------------------</span>
<span class="c"># Alias settings</span>
<span class="c">#-------------------------------------</span>
<span class="c"># basic</span>
<span class="nb">alias grep</span><span class="o">=</span><span class="s1">'grep --color=auto'</span>
<span class="nb">alias ls</span><span class="o">=</span><span class="s1">'ls -F --color=auto --group-directories-first'</span>
<span class="nb">alias </span>log-out<span class="o">=</span><span class="s1">'gnome-session-quit'</span>

<span class="c"># git</span>
<span class="nb">alias </span>git-cd<span class="o">=</span><span class="s1">'cd "$(git root)"'</span>

<span class="c"># vscode</span>
<span class="nb">alias </span>code-cd<span class="o">=</span><span class="s1">'if [[ -z $VSCODE_WS ]]; then echo "There is no VSCODE_WS variable"; else cd $VSCODE_WS; fi'</span>


<span class="c">#-------------------------------------</span>
<span class="c"># Function settings</span>
<span class="c">#-------------------------------------</span>
<span class="c"># general</span>
<span class="nb">source</span> ~/.zsh.d/bin/util_function.sh

<span class="c"># package suggest</span>
<span class="k">function </span>command_not_found_handler<span class="o">()</span> <span class="o">{</span>
  <span class="c"># check because c-n-f could've been removed in the meantime</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nt">-x</span> /usr/lib/command-not-found <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
	   /usr/lib/command-not-found <span class="nt">--</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
     <span class="k">return</span> <span class="nv">$?</span>
  <span class="k">elif</span> <span class="o">[</span> <span class="nt">-x</span> /usr/share/command-not-found/command-not-found <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
	   /usr/share/command-not-found/command-not-found <span class="nt">--</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
     <span class="k">return</span> <span class="nv">$?</span>
	<span class="k">else
		 </span><span class="nb">printf</span> <span class="s2">"%s: command not found</span><span class="se">\n</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span> <span class="o">&gt;</span>&amp;2
		 <span class="k">return </span>127
	<span class="k">fi</span>
<span class="o">}</span>


<span class="c">#-------------------------------------</span>
<span class="c"># Completion</span>
<span class="c">#-------------------------------------</span>
<span class="c"># general</span>
autoload <span class="nt">-Uz</span> compinit <span class="o">&amp;&amp;</span> compinit
setopt complete_in_word <span class="c"># enable Tab completion even while typing a word</span>

<span class="c"># suggest</span>
zstyle <span class="s1">':completion:*'</span> completer _complete _match _prefix:-complete _list _correct _approximate _prefix:-approximate 
zstyle <span class="s1">':completion:*'</span> group-name <span class="s1">''</span>
zstyle <span class="s1">':completion:*'</span> list-prompt %SAt %p: Hit TAB <span class="k">for </span>more, or the character to insert%s
zstyle <span class="s1">':completion:*'</span> verbose <span class="nb">yes</span>

<span class="c"># style: info</span>
zstyle <span class="s1">':completion:*:descriptions'</span> format <span class="s1">$'%{</span><span class="se">\e</span><span class="s1">[01;31m%}---- %d%{</span><span class="se">\e</span><span class="s1">[m%}'</span>
zstyle <span class="s1">':completion:*:messages'</span> format <span class="s1">$'%{</span><span class="se">\e</span><span class="s1">[01;04;31m%}---- %d%{</span><span class="se">\e</span><span class="s1">[m%}'</span>
zstyle <span class="s1">':completion:*:warnings'</span> format <span class="s1">$'%{</span><span class="se">\e</span><span class="s1">[01;04;31m%}---- No matches for: %d%{</span><span class="se">\e</span><span class="s1">[m%}'</span>
zstyle <span class="s1">':completion:*:corrections'</span> format <span class="s1">$'%{</span><span class="se">\e</span><span class="s1">[0;31m%}%d (errors: %e)%{</span><span class="se">\e</span><span class="s1">[m%}'</span>

<span class="c"># style: matching</span>
zstyle <span class="s1">':completion:*'</span> matcher-list <span class="s1">''</span> <span class="s1">'m:{a-z}={A-Z}'</span> <span class="s1">'m:{a-zA-Z}={A-Za-z}'</span> <span class="s1">'r:|[._-]=* r:|=* l:|=*'</span>
zstyle <span class="s1">':completion:*'</span> use-compctl <span class="nb">false</span> <span class="c"># turn off old compctl completion</span>

<span class="c"># style: color</span>
<span class="nb">eval</span> <span class="si">$(</span><span class="nb">dircolors</span><span class="si">)</span>
zstyle <span class="s1">':completion:*'</span> list-colors <span class="k">${</span><span class="p">(s.</span>:.<span class="p">)LS_COLORS</span><span class="k">}</span>
autoload colors <span class="o">&amp;&amp;</span> colors

<span class="c"># kill</span>
zstyle <span class="s1">':completion:*:*:kill:*:processes'</span> list-colors <span class="s1">'=(#b) #([0-9]#)*=0=01;31'</span>
zstyle <span class="s1">':completion:*:kill:*'</span> <span class="nb">command</span> <span class="s1">'ps -u $USER -o pid,%cpu,tty,cputime,cmd'</span>


<span class="c">#-------------------------------------</span>
<span class="c"># Prompt setting: Git</span>
<span class="c">#-------------------------------------</span>
autoload <span class="nt">-Uz</span> add-zsh-hook 
<span class="nb">source</span> ~/.zsh.d/bin/git-prompt.sh
setopt PROMPT_SUBST

prompt_setup<span class="o">()</span> <span class="o">{</span>
    <span class="nv">prompt_color1</span><span class="o">=</span><span class="k">${</span><span class="nv">1</span><span class="k">:-</span><span class="s1">'cyan'</span><span class="k">}</span>
    <span class="nv">prompt_color2</span><span class="o">=</span><span class="k">${</span><span class="nv">2</span><span class="k">:-</span><span class="s1">'green'</span><span class="k">}</span>

    <span class="nv">base_prompt</span><span class="o">=</span><span class="s2">"%F{</span><span class="nv">$prompt_color1</span><span class="s2">}%n@%m%f %F{</span><span class="nv">$prompt_color2</span><span class="s2">}%B%~%b%f "</span>
    <span class="nv">git_prompt</span><span class="o">=</span><span class="s1">'$(__posh_git_echo)'</span>
    <span class="nv">post_prompt</span><span class="o">=</span><span class="s1">$'</span><span class="se">\n</span><span class="s1">'</span><span class="s2">"%# "</span>

    <span class="nv">PROMPT</span><span class="o">=</span><span class="nv">$base_prompt$git_prompt$post_prompt</span>
<span class="o">}</span>

add-zsh-hook precmd prompt_setup
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="1-ヒストリーサイズの再設定">(1) ヒストリーサイズの再設定</h4>

<p>ヒストリーサイズが小さいと振り返りがしづらくなるので変更する.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="c"># -----------------------------</span>
<span class="c"># History</span>
<span class="c"># -----------------------------</span>
<span class="nv">HISTSIZE</span><span class="o">=</span>1000                   <span class="c"># history -xのxのlimit</span>
<span class="nv">SAVEHIST</span><span class="o">=</span>100000000              <span class="c"># 4年後replaceを考えているので全部記録程度</span>
<span class="nv">HISTFILE</span><span class="o">=</span>~/.zsh.d/.zsh_history  <span class="c"># history fileの保存先の指定</span>
setopt extended_history         <span class="c"># record shitory with timestamp, history -i</span>
setopt hist_ignore_space        <span class="c"># スペースで始まるコマンドラインはヒストリに追加しない.</span>
setopt inc_append_history       <span class="c"># すぐにヒストリファイルに追記する.</span>
setopt share_history            <span class="c"># share history between zsh processes</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="2-zshのgit-command補完を有効にする">(2) Zshのgit command補完を有効にする</h4>

<p>Zshには,Git用のタブ補完ライブラリも同梱されています.
<code class="language-plaintext highlighter-rouge">.zshrc</code>に<code class="language-plaintext highlighter-rouge">autoload -Uz compinit &amp;&amp; compinit</code>という行を追加するだけで
使えるようになります.使用感は以下のような感じです:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>% git che&lt;tab&gt;
check-attr        -- display gitattributes information
check-ref-format  -- ensure that a reference name is well formed
checkout          -- checkout branch or paths to working tree
checkout-index    -- copy files from index to working directory
cherry            -- find commits not merged upstream
cherry-pick       -- apply changes introduced by some existing commits
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="3-git-posh-like-git-prompt">(3) git-posh like git prompt</h4>

<p>目指したい形はTerminal上にpowershell-likeに以下の表示をさせることです</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>username@hostname ~/test_dir <span class="o">[</span>branch_name ≡ +1 ~2 <span class="nt">-0</span> <span class="o">!]</span>
% 
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>Requirement</p>
</blockquote>

<p>パワーライン用のフォントをapt package manager経由でインストールします.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% <span class="nb">sudo </span>apt <span class="nb">install </span>powerline
</pre></td></tr></tbody></table></code></pre></div></div>

<p>posh-git-shの<code class="language-plaintext highlighter-rouge">git-prompt.sh</code>をLocalの任意の場所(<code class="language-plaintext highlighter-rouge">~/.zsh.d/bin/git-prompt.sh</code>)にcopy</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>% curl https://raw.githubusercontent.com/lyze/posh-git-sh/master/git-prompt.sh <span class="o">&gt;</span> ~/.zsh.d/bin/git-prompt.sh
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">~/.zshrc</code>での書き方</p>
</blockquote>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="c">#-------------------------------------</span>
<span class="c"># Prompt setting: Git</span>
<span class="c">#-------------------------------------</span>
autoload <span class="nt">-Uz</span> add-zsh-hook 
<span class="nb">source</span> ~/.zsh.d/bin/git-prompt.sh
setopt PROMPT_SUBST

prompt_setup<span class="o">()</span> <span class="o">{</span>
    <span class="nv">prompt_color1</span><span class="o">=</span><span class="k">${</span><span class="nv">1</span><span class="k">:-</span><span class="s1">'cyan'</span><span class="k">}</span>
    <span class="nv">prompt_color2</span><span class="o">=</span><span class="k">${</span><span class="nv">2</span><span class="k">:-</span><span class="s1">'green'</span><span class="k">}</span>

    <span class="nv">base_prompt</span><span class="o">=</span><span class="s2">"%F{</span><span class="nv">$prompt_color1</span><span class="s2">}%n@%m%f %F{</span><span class="nv">$prompt_color2</span><span class="s2">}%B%~%b%f "</span>
    <span class="nv">git_prompt</span><span class="o">=</span><span class="s1">'$(__posh_git_echo)'</span>
    <span class="nv">post_prompt</span><span class="o">=</span><span class="s1">$'</span><span class="se">\n</span><span class="s1">'</span><span class="s2">"%# "</span>

    <span class="nv">PROMPT</span><span class="o">=</span><span class="nv">$base_prompt$git_prompt$post_prompt</span>
<span class="o">}</span>

add-zsh-hook precmd prompt_setup
</pre></td></tr></tbody></table></code></pre></div></div>

<div style="padding-left: 2em; padding-right: 2em; border-radius: 1em; border-style:solid; border-color:#e6e6fa; background-color:#e6e6fa">
  <p class="h4"><ins>Column: aliasを一時的に解除したい場合</ins></p>

  <p><code class="language-plaintext highlighter-rouge">.zshrc</code>にて, <code class="language-plaintext highlighter-rouge">ls</code>と<code class="language-plaintext highlighter-rouge">grep</code>コマンドのaliasを設定していますが, 一時的に解除してそれぞれのコマンドを実行したい場合は, <code class="language-plaintext highlighter-rouge">\</code>をコマンドに付与して実行します:</p>

  <div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c">### 一時的にaliasを解除したい場合</span>
% <span class="se">\l</span>s

<span class="c">### aliasを解除したい場合（session中解除される）</span>
% <span class="nb">unalias ls</span>
</pre></td></tr></tbody></table></code></pre></div>  </div>

</div>

<h2 id="appendix">Appendix</h2>
<h3 id="chshコマンド">chshコマンド</h3>

<p><strong>機能</strong></p>

<ul>
  <li>ログインシェルを変更するコマンド</li>
  <li>一般ユーザは自分のアカウントのログインシェルのみを変更できるが, スーパーユーザは全てのアカウントのログインシェルを変更できます</li>
</ul>

<p><strong>Syntax</strong></p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>chsh <span class="o">[</span><span class="nt">-s</span> login_shell] <span class="o">[</span>user]
</pre></td></tr></tbody></table></code></pre></div></div>

<table>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">-h, --help</code></td>
      <td>ヘルプメッセージの表示</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">-R, --root CHROOT_DIR</code></td>
      <td>directory to chroot into</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">-s, --shell SHELL</code></td>
      <td>現在のユーザーのログインシェルを設定</td>
    </tr>
  </tbody>
</table>

<p><strong>Exmaple</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c">#bashに変更</span>
chsh <span class="nt">-s</span> /bin/bash
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>設定可能なログインシェルリストの表示</strong></p>

<p>設定可能なシェルは<code class="language-plaintext highlighter-rouge">/etc/shells</code>ファイルに登録されているのでこれを表示させれば十分です.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>% <span class="nb">cat</span> /etc/shells
<span class="c"># /etc/shells: valid login shells</span>
/bin/sh
/bin/bash
/usr/bin/bash
/bin/rbash
/usr/bin/rbash
/bin/dash
/usr/bin/dash
/bin/zsh
/usr/bin/zsh
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="pathの設定">PATHの設定</h3>

<p>ファイルを開いたり, コマンドを実行したりするには, そのファイルやコマンドの場所を正確に指定しないとカーネルは何を実行していいか理解することができません.
この場所指定のことを<strong>PATH</strong>といいます.</p>

<div style="padding-left: 2em; padding-right: 2em; border-radius: 1em; border-style:solid; border-color:#D3D3D3; background-color:#F8F8F8">
  <p class="h4"><ins>Def: PATHを通す</ins></p>

  <p>コマンドのあるディレクトのパスを設定することでを環境変数<code class="language-plaintext highlighter-rouge">PATH</code>に登録することを「<strong>PATHを通す</strong>」という.
PATHを通すことによって,</p>

  <ul>
    <li>コマンド実行時にKernelが環境変数<code class="language-plaintext highlighter-rouge">PATH</code>で指定されたディレクトリを確認</li>
    <li>各コマンドの実行ファイルを見つけ出す</li>
    <li>入力されたコマンド使える</li>
  </ul>

  <p>という仕組みになっている</p>
</div>

<p>現在のシェルのPATH変数は以下のコマンドで確認できます:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>% <span class="nb">echo</span> <span class="nv">$PATH</span>
/home/hoge/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
</pre></td></tr></tbody></table></code></pre></div></div>

<p>上記の例でわかるように, 複数のPATHは <code class="language-plaintext highlighter-rouge">:</code> で繋がれています. 前にある方が優先順位が高く,
<code class="language-plaintext highlighter-rouge">/usr/local/bin:/bin:/usr/bin</code> と指定されている場合は <code class="language-plaintext highlighter-rouge">/usr/local/bin</code> にある実行可能ファイルが優先されます.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c"># $HOME/binを優先したい場合</span>
% <span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/bin:</span><span class="nv">$PATH</span><span class="s2">"</span>

<span class="c"># $HOME/binを最後に見るように設定したい場合</span>
% <span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">"</span><span class="nv">$PATH</span><span class="s2">:</span><span class="nv">$HOME</span><span class="s2">/bin"</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="references">References</h2>

<blockquote>
  <p>General</p>
</blockquote>

<ul>
  <li><a href="https://zsh.sourceforge.io/">Z shell official website</a></li>
</ul>

<blockquote>
  <p>git-prompt</p>
</blockquote>

<ul>
  <li><a href="https://github.com/dahlbyk/posh-git">GitHub.com &gt; lyze/posh-git-sh</a></li>
</ul>

<blockquote>
  <p>apt package suggestion</p>
</blockquote>

<ul>
  <li><a href="https://ryonakagami.github.io/2022/02/06/suggest-apt-packages-function/">Ryo’s Tech Blog &gt; Linux基礎知識：bash環境でのパッケージのサジェスト機能</a></li>
</ul>


                <hr style="visibility: hidden;">
                <hr/>
                <b><fontsize="5">Share Buttons</font><br></b>
                <!--see 
    https://jekyllcodex.org/without-plugin/share-buttons/ 
    https://ranvir.xyz/blog/why-and-how-to-add-social-sharing-buttons-on-your-jekyll-blog-using-github-pages/
-->



<style>
#share-buttons {display: inline-block; vertical-align: middle; }
#share-buttons:after {content: ""; display: block; clear: both;}
#share-buttons > div {
    position: relative;
    text-align: left; 
    height: 36px; 
    width: 32px; 
    float: left; 
    text-align: center;
}
#share-buttons > div > svg {height: 16px; fill: #d5d5d5; margin-top: 10px;}
#share-buttons > div:hover {cursor: pointer;}
#share-buttons > div.facebook:hover > svg {fill: #3B5998;}
#share-buttons > div.twitter:hover > svg {fill: #55ACEE;}
#share-buttons > div.linkedin:hover > svg {fill: #0077b5;}
#share-buttons > div.pinterest:hover > svg {fill: #CB2027;}
#share-buttons > div.gplus:hover > svg {fill: #dd4b39;}
#share-buttons > div.mail:hover > svg {fill: #7D7D7D;}
#share-buttons > div.instagram:hover > svg {fill: #C73B92;}
#share-buttons > div.facebook > svg {height: 18px; margin-top: 9px;}
#share-buttons > div.twitter > svg {height: 20px; margin-top: 8px;}
#share-buttons > div.linkedin > svg {height: 19px; margin-top: 7px;}
#share-buttons > div.pinterest > svg {height: 20px; margin-top: 9px;}
#share-buttons > div.gplus > svg {height: 17px; margin-top: 9px; position: relative; left: 1px;}
#share-buttons > div.mail > svg {height: 14px; margin-top: 11px;}
</style>

<span style="color: black">Share on: </span><div id="share-buttons">
    <div class="facebook" title="Share this on Facebook" onclick="gtag('event', 'Facebook', {'event_category':'Post Shared','event_label':'Facebook'}); location.href='http://www.facebook.com/share.php?u=https://ryonakagami.github.io/2020/12/23/ubuntu-zshsetup/';"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759h-306v-759h-255v-296h255v-218q0-186 104-288.5t277-102.5q147 0 228 12z"/></svg></div>
    <div class="twitter" title="Share this on Twitter" onclick="gtag('event', 'Twitter', {'event_category':'Post Shared','event_label':'Twitter'}); location.href='https://twitter.com/intent/tweet?text=Z shell installation and configuration&url=https://ryonakagami.github.io/2020/12/23/ubuntu-zshsetup/';"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"/></svg></div>
    <div class="linkedin" title="Share this on Linkedin" onclick="gtag('event', 'Linkedin', {'event_category':'Post Shared','event_label':'Linkedin'}); location.href='https://www.linkedin.com/shareArticle?mini=true&url=https://ryonakagami.github.io/2020/12/23/ubuntu-zshsetup/&title=&summary=&source=';"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"/></svg></div>
    
    <div class="mail" title="Share this through Email" onclick="gtag('event', 'Email', {'event_category':'Post Shared','event_label':'Email'}); location.href='mailto:?&body=https://ryonakagami.github.io/2020/12/23/ubuntu-zshsetup/';"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1792 710v794q0 66-47 113t-113 47h-1472q-66 0-113-47t-47-113v-794q44 49 101 87 362 246 497 345 57 42 92.5 65.5t94.5 48 110 24.5h2q51 0 110-24.5t94.5-48 92.5-65.5q170-123 498-345 57-39 100-87zm0-294q0 79-49 151t-122 123q-376 261-468 325-10 7-42.5 30.5t-54 38-52 32.5-57.5 27-50 9h-2q-23 0-50-9t-57.5-27-52-32.5-54-38-42.5-30.5q-91-64-262-182.5t-205-142.5q-62-42-117-115.5t-55-136.5q0-78 41.5-130t118.5-52h1472q65 0 112.5 47t47.5 113z"/></svg></div>
</div>

                
                <hr/>

                <!-- Featured Tags -->
                <b><fontsize="5">Feature Tags</b>
                    <div id="tag_cloud" class="tags tags-sup js-tags" 
                    style="line-height: 0px !important;">
                        
                        
                        
                        
                        
                                <a data-sort="0288" 
                                    href="/archive/?tag=%E7%B5%B1%E8%A8%88"
                                    title="統計"
                                    style="color: #337ab7 !important;"
                                    rel="61">統計</a>
                        
                                <a data-sort="0298" 
                                    href="/archive/?tag=Python"
                                    title="Python"
                                    style="color: #337ab7 !important;"
                                    rel="51">Python</a>
                        
                                <a data-sort="0300" 
                                    href="/archive/?tag=math"
                                    title="math"
                                    style="color: #337ab7 !important;"
                                    rel="49">math</a>
                        
                                <a data-sort="0303" 
                                    href="/archive/?tag=Linux"
                                    title="Linux"
                                    style="color: #337ab7 !important;"
                                    rel="46">Linux</a>
                        
                                <a data-sort="0316" 
                                    href="/archive/?tag=Ubuntu+20.04+LTS"
                                    title="Ubuntu 20.04 LTS"
                                    style="color: #337ab7 !important;"
                                    rel="33">Ubuntu 20.04 LTS</a>
                        
                                <a data-sort="0319" 
                                    href="/archive/?tag=Shell"
                                    title="Shell"
                                    style="color: #337ab7 !important;"
                                    rel="30">Shell</a>
                        
                                <a data-sort="0321" 
                                    href="/archive/?tag=English"
                                    title="English"
                                    style="color: #337ab7 !important;"
                                    rel="28">English</a>
                        
                                <a data-sort="0324" 
                                    href="/archive/?tag=git"
                                    title="git"
                                    style="color: #337ab7 !important;"
                                    rel="25">git</a>
                        
                                <a data-sort="0329" 
                                    href="/archive/?tag=%E6%96%B9%E6%B3%95%E8%AB%96"
                                    title="方法論"
                                    style="color: #337ab7 !important;"
                                    rel="20">方法論</a>
                        
                                <a data-sort="0333" 
                                    href="/archive/?tag=Ubuntu+22.04+LTS"
                                    title="Ubuntu 22.04 LTS"
                                    style="color: #337ab7 !important;"
                                    rel="16">Ubuntu 22.04 LTS</a>
                        
                                <a data-sort="0337" 
                                    href="/archive/?tag=%E7%B5%B1%E8%A8%88%E6%A4%9C%E5%AE%9A"
                                    title="統計検定"
                                    style="color: #337ab7 !important;"
                                    rel="12">統計検定</a>
                        
                                <a data-sort="0338" 
                                    href="/archive/?tag=%E7%AB%B6%E6%8A%80%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0"
                                    title="競技プログラミング"
                                    style="color: #337ab7 !important;"
                                    rel="11">競技プログラミング</a>
                        
                                <a data-sort="0339" 
                                    href="/archive/?tag=%E3%83%95%E3%83%BC%E3%83%AA%E3%82%A8%E8%A7%A3%E6%9E%90"
                                    title="フーリエ解析"
                                    style="color: #337ab7 !important;"
                                    rel="10">フーリエ解析</a>
                        
                                <a data-sort="0340" 
                                    href="/archive/?tag=%E5%89%8D%E5%87%A6%E7%90%86"
                                    title="前処理"
                                    style="color: #337ab7 !important;"
                                    rel="9">前処理</a>
                        
                                <a data-sort="0340" 
                                    href="/archive/?tag=SQL"
                                    title="SQL"
                                    style="color: #337ab7 !important;"
                                    rel="9">SQL</a>
                        
                                <a data-sort="0340" 
                                    href="/archive/?tag=coding"
                                    title="coding"
                                    style="color: #337ab7 !important;"
                                    rel="9">coding</a>
                        
                                <a data-sort="0341" 
                                    href="/archive/?tag=%E3%82%B3%E3%83%9F%E3%83%A5%E3%83%8B%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3"
                                    title="コミュニケーション"
                                    style="color: #337ab7 !important;"
                                    rel="8">コミュニケーション</a>
                        
                                <a data-sort="0342" 
                                    href="/archive/?tag=Network"
                                    title="Network"
                                    style="color: #337ab7 !important;"
                                    rel="7">Network</a>
                        
                                <a data-sort="0342" 
                                    href="/archive/?tag=ssh"
                                    title="ssh"
                                    style="color: #337ab7 !important;"
                                    rel="7">ssh</a>
                        
                                <a data-sort="0343" 
                                    href="/archive/?tag=%E5%B0%86%E6%A3%8B"
                                    title="将棋"
                                    style="color: #337ab7 !important;"
                                    rel="6">将棋</a>
                        
                                <a data-sort="0343" 
                                    href="/archive/?tag=Data+visualization"
                                    title="Data visualization"
                                    style="color: #337ab7 !important;"
                                    rel="6">Data visualization</a>
                        
                                <a data-sort="0343" 
                                    href="/archive/?tag=Docker"
                                    title="Docker"
                                    style="color: #337ab7 !important;"
                                    rel="6">Docker</a>
                        
                                <a data-sort="0343" 
                                    href="/archive/?tag=Econometrics"
                                    title="Econometrics"
                                    style="color: #337ab7 !important;"
                                    rel="6">Econometrics</a>
                        
                                <a data-sort="0343" 
                                    href="/archive/?tag=VSCode"
                                    title="VSCode"
                                    style="color: #337ab7 !important;"
                                    rel="6">VSCode</a>
                        
                                <a data-sort="0343" 
                                    href="/archive/?tag=statistical+inference"
                                    title="statistical inference"
                                    style="color: #337ab7 !important;"
                                    rel="6">statistical inference</a>
                        
                                <a data-sort="0344" 
                                    href="/archive/?tag=GitHub+Pages"
                                    title="GitHub Pages"
                                    style="color: #337ab7 !important;"
                                    rel="5">GitHub Pages</a>
                        
                                <a data-sort="0344" 
                                    href="/archive/?tag=apt"
                                    title="apt"
                                    style="color: #337ab7 !important;"
                                    rel="5">apt</a>
                        
                                <a data-sort="0344" 
                                    href="/archive/?tag=development"
                                    title="development"
                                    style="color: #337ab7 !important;"
                                    rel="5">development</a>
                        
                                <a data-sort="0345" 
                                    href="/archive/?tag=%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E7%AE%A1%E7%90%86"
                                    title="システム管理"
                                    style="color: #337ab7 !important;"
                                    rel="4">システム管理</a>
                        
                                <a data-sort="0345" 
                                    href="/archive/?tag=Coffee"
                                    title="Coffee"
                                    style="color: #337ab7 !important;"
                                    rel="4">Coffee</a>
                        
                                <a data-sort="0345" 
                                    href="/archive/?tag=cloud"
                                    title="cloud"
                                    style="color: #337ab7 !important;"
                                    rel="4">cloud</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=%E6%95%B0%E5%80%A4%E8%A8%88%E7%AE%97"
                                    title="数値計算"
                                    style="color: #337ab7 !important;"
                                    rel="3">数値計算</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=%E7%B4%A0%E6%95%B0"
                                    title="素数"
                                    style="color: #337ab7 !important;"
                                    rel="3">素数</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=Book"
                                    title="Book"
                                    style="color: #337ab7 !important;"
                                    rel="3">Book</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=Font"
                                    title="Font"
                                    style="color: #337ab7 !important;"
                                    rel="3">Font</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=Metrics"
                                    title="Metrics"
                                    style="color: #337ab7 !important;"
                                    rel="3">Metrics</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=Poetry"
                                    title="Poetry"
                                    style="color: #337ab7 !important;"
                                    rel="3">Poetry</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=Ubuntu+24.04+LTS"
                                    title="Ubuntu 24.04 LTS"
                                    style="color: #337ab7 !important;"
                                    rel="3">Ubuntu 24.04 LTS</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=architecture"
                                    title="architecture"
                                    style="color: #337ab7 !important;"
                                    rel="3">architecture</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=aws"
                                    title="aws"
                                    style="color: #337ab7 !important;"
                                    rel="3">aws</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=shell"
                                    title="shell"
                                    style="color: #337ab7 !important;"
                                    rel="3">shell</a>
                        
                                <a data-sort="0346" 
                                    href="/archive/?tag=systemctl"
                                    title="systemctl"
                                    style="color: #337ab7 !important;"
                                    rel="3">systemctl</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88"
                                    title="テンプレート"
                                    style="color: #337ab7 !important;"
                                    rel="2">テンプレート</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=%E3%83%87%E3%83%BC%E3%82%BF%E6%A7%8B%E9%80%A0"
                                    title="データ構造"
                                    style="color: #337ab7 !important;"
                                    rel="2">データ構造</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=%E3%83%9D%E3%83%AF%E3%82%BD%E3%83%B3%E5%88%86%E5%B8%83"
                                    title="ポワソン分布"
                                    style="color: #337ab7 !important;"
                                    rel="2">ポワソン分布</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=%E4%BC%9A%E8%A8%88%E5%88%86%E6%9E%90"
                                    title="会計分析"
                                    style="color: #337ab7 !important;"
                                    rel="2">会計分析</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=%E6%96%87%E5%AD%97%E3%82%B3%E3%83%BC%E3%83%89"
                                    title="文字コード"
                                    style="color: #337ab7 !important;"
                                    rel="2">文字コード</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89"
                                    title="環境構築"
                                    style="color: #337ab7 !important;"
                                    rel="2">環境構築</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=%E8%AB%96%E6%96%87"
                                    title="論文"
                                    style="color: #337ab7 !important;"
                                    rel="2">論文</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=App"
                                    title="App"
                                    style="color: #337ab7 !important;"
                                    rel="2">App</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=Bayesian"
                                    title="Bayesian"
                                    style="color: #337ab7 !important;"
                                    rel="2">Bayesian</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=Dynamic+Programming"
                                    title="Dynamic Programming"
                                    style="color: #337ab7 !important;"
                                    rel="2">Dynamic Programming</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=Keyboard"
                                    title="Keyboard"
                                    style="color: #337ab7 !important;"
                                    rel="2">Keyboard</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=Processing"
                                    title="Processing"
                                    style="color: #337ab7 !important;"
                                    rel="2">Processing</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=R"
                                    title="R"
                                    style="color: #337ab7 !important;"
                                    rel="2">R</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=Steam"
                                    title="Steam"
                                    style="color: #337ab7 !important;"
                                    rel="2">Steam</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=filesystem"
                                    title="filesystem"
                                    style="color: #337ab7 !important;"
                                    rel="2">filesystem</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=quarto"
                                    title="quarto"
                                    style="color: #337ab7 !important;"
                                    rel="2">quarto</a>
                        
                                <a data-sort="0347" 
                                    href="/archive/?tag=regex"
                                    title="regex"
                                    style="color: #337ab7 !important;"
                                    rel="2">regex</a>
                    </div>

                <br>

                <b><fontsize="5">Leave a Comment</font><br>(注意：GitHub Accountが必要となります）</b>
                
                <script src="https://utteranc.es/client.js"
                    repo="RyoNakagami/RyoNakagami.github.io"
                    issue-term="url"
                    theme="github-light"
                    crossorigin="anonymous"
                    async>Reduce unused JavaScript
                
                </script>


            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-1 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog fixed" style="margin-top:3%">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CONTENTS</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        
    <!-- Sidebar Container -->
            <!-- <div class="
                col-lg-10 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container row"> -->
                <!-- 
<hr>
<h5>FRIENDS</h5>
<ul class="list-inline">
  
  <li><a href="https://twitter.com/bluesky0804?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor">bluesky0804</a></li>
  
</ul>

 -->
            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'right',
          // icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>


<body>
    <!-- enable mermaid language on markdown post -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
<script>
   mermaid.initialize({
       startOnLoad:true,
       theme: 'default'
   });
   window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
</script>

</body>

    <script>
    
    var elements = document.querySelectorAll('p');
    Array.prototype.forEach.call(elements, function(el, i){
        if(el.innerHTML=='[expand]') {
            var parentcontent = el.parentNode.innerHTML.replace('<p>[expand]</p>','<div class="expand" style="display: none; height: 0; overflow: hidden;">').replace('<p>[/expand]</p>','</div>');
            el.parentNode.innerHTML = parentcontent;
        }
    });

    var elements = document.querySelectorAll('div.expand');
    Array.prototype.forEach.call(elements, function(el, i){
        el.previousElementSibling.innerHTML = el.previousElementSibling.innerHTML + '<span>..&nbsp; <a href="#" style="cursor: pointer;" onclick="this.parentNode.parentNode.nextElementSibling.style.display = \'block\'; this.parentNode.parentNode.nextElementSibling.style.height = \'auto\'; this.parentNode.style.display = \'none\';">read&nbsp;more&nbsp;&rarr;</a></span>';
    });

</script>

    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <!--<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"> -->
                <!-- SNS Link -->
            


<ul class="list-inline text-center">


  
  
  
  
  <li>
    <a target="_blank" href="https://github.com/RyoNakagami">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
</ul>

            
            <p class="copyright text-muted">
                Copyright &copy; Ryo's Tech Blog 2025
                <br>
                Powered by <a href="https://ryonakagami.github.io">Ryo's Tech Blog</a> |
                <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="100px"
                    height="20px"
                    title="RyoNakagami.github.io github stars"
                    src="https://ghbtns.com/github-btn.html?user=RyoNakagami&repo=RyoNakagami.github.io&type=star&count=true">
                </iframe>
            </p>
            <!--</div> -->
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/ryo-blog.min.js "></script>

<!-- Simple Jekyll Search -->
<script src="/js/simple-jekyll-search.min.js"></script>

<!-- Service Worker -->

<script src="/js/snackbar.js "></script>
<script src="/js/sw-registration.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->







<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LVL413SV09"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-LVL413SV09');
</script>



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog(selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->


<!-- Simple Jekyll Search -->
<script>
    // https://stackoverflow.com/questions/1912501/unescape-html-entities-in-javascript
    function htmlDecode(input) {
        var e = document.createElement('textarea');
        e.innerHTML = input;
        // handle case of empty input
        return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
    }

    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('search-results'),
        json: '/search.json',
        searchResultTemplate: '<div class="post-preview item"><a href="{url}"><h2 class="post-title">{title}</h2><h3 class="post-subtitle">{subtitle}</h3><hr></a></div>',
        noResultsText: 'No results',
        limit: 50,
        fuzzy: false,
        // a hack to get escaped subtitle unescaped. for some reason, 
        // post.subtitle w/o escape filter nuke entire search.
        templateMiddleware: function (prop, value, template) {
            if (prop === 'subtitle' || prop === 'title') {
                if (value.indexOf("code")) {
                    return htmlDecode(value);
                } else {
                    return value;
                }
            }
        }
    });

    $(document).ready(function () {
        var $searchPage = $('.search-page');
        var $searchOpen = $('.search-icon');
        var $searchClose = $('.search-icon-close');
        var $searchInput = $('#search-input');
        var $body = $('body');

        $searchOpen.on('click', function (e) {
            e.preventDefault();
            $searchPage.toggleClass('search-active');
            var prevClasses = $body.attr('class') || '';
            setTimeout(function () {
                $body.addClass('no-scroll');
            }, 400)

            if ($searchPage.hasClass('search-active')) {
                $searchClose.on('click', function (e) {
                    e.preventDefault();
                    $searchPage.removeClass('search-active');
                    $body.attr('class', prevClasses);  // from closure 
                });
                $searchInput.focus();
            }
        });
    });
</script>



<!-- Image to Github 
<img src="/img/icon_wechat.png" width="0" height="0" />
<-- Migrate from head to bottom, no longer block render and still work -->
<script>
    
    var elements = document.querySelectorAll('p');
    Array.prototype.forEach.call(elements, function(el, i){
        if(el.innerHTML=='[expand]') {
            var parentcontent = el.parentNode.innerHTML.replace('<p>[expand]</p>','<div class="expand" style="display: none; height: 0; overflow: hidden;">').replace('<p>[/expand]</p>','</div>');
            el.parentNode.innerHTML = parentcontent;
        }
    });

    var elements = document.querySelectorAll('div.expand');
    Array.prototype.forEach.call(elements, function(el, i){
        el.previousElementSibling.innerHTML = el.previousElementSibling.innerHTML + '<span>..&nbsp; <a href="#" style="cursor: pointer;" onclick="this.parentNode.parentNode.nextElementSibling.style.display = \'block\'; this.parentNode.parentNode.nextElementSibling.style.height = \'auto\'; this.parentNode.style.display = \'none\';">read&nbsp;more&nbsp;&rarr;</a></span>';
    });

</script>

</body>
</html>
