---
layout: post
title: "道具としてのファイナンス勉強ノート"
subtitle: "プロジェクト投資判断のポイントまとめ"
author: "Ryo"
header-img: "img/about-bg.jpg"
header-mask: 0.4
catelog: true
mathjax: true
purpose: 
tags:

- finance
---

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LVL413SV09"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LVL413SV09');
</script>

||概要|
|---|---|
|目的|道具としてファイナンスを用いることができるようになりたい|
|解決したい課題||
|参考|- [Token authentication requirements for Git operations](https://github.blog/2020-12-15-token-authentication-requirements-for-git-operations/)<br>- [個人アクセストークンを使用する](https://docs.github.com/ja/github-ae@latest/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token)|
|過去関連記事|[Ubuntu 20.04 LTS git GitHub Ubuntu Desktop環境構築 Part 13 - GitとGitHubの設定](https://ryonakagami.github.io/2020/12/28/ubuntu-git-and-github-setup/)|

<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

- [はじめに](#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB)
  - [計算環境/Computation Language](#%E8%A8%88%E7%AE%97%E7%92%B0%E5%A2%83computation-language)
- [ファイナンスとは？](#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%8A%E3%83%B3%E3%82%B9%E3%81%A8%E3%81%AF)
- [投資判断](#%E6%8A%95%E8%B3%87%E5%88%A4%E6%96%AD)
  - [キャッシュフロー計算書(C/F)とは](#%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%83%95%E3%83%AD%E3%83%BC%E8%A8%88%E7%AE%97%E6%9B%B8cf%E3%81%A8%E3%81%AF)
  - [投資判断指標の例](#%E6%8A%95%E8%B3%87%E5%88%A4%E6%96%AD%E6%8C%87%E6%A8%99%E3%81%AE%E4%BE%8B)
  - [資本支出予算管理 (capital budgeting)](#%E8%B3%87%E6%9C%AC%E6%94%AF%E5%87%BA%E4%BA%88%E7%AE%97%E7%AE%A1%E7%90%86-capital-budgeting)
  - [異なる期間のプロジェクトを比較する場合](#%E7%95%B0%E3%81%AA%E3%82%8B%E6%9C%9F%E9%96%93%E3%81%AE%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E6%AF%94%E8%BC%83%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88)
  - [With-Wothoutの原則（機会費用）](#with-wothout%E3%81%AE%E5%8E%9F%E5%89%87%E6%A9%9F%E4%BC%9A%E8%B2%BB%E7%94%A8)
  - [リスクと不確実性](#%E3%83%AA%E3%82%B9%E3%82%AF%E3%81%A8%E4%B8%8D%E7%A2%BA%E5%AE%9F%E6%80%A7)
    - [ポートフォリオの期待収益率と分散](#%E3%83%9D%E3%83%BC%E3%83%88%E3%83%95%E3%82%A9%E3%83%AA%E3%82%AA%E3%81%AE%E6%9C%9F%E5%BE%85%E5%8F%8E%E7%9B%8A%E7%8E%87%E3%81%A8%E5%88%86%E6%95%A3)
    - [どの水準のポートフォリオを選択するべきか？](#%E3%81%A9%E3%81%AE%E6%B0%B4%E6%BA%96%E3%81%AE%E3%83%9D%E3%83%BC%E3%83%88%E3%83%95%E3%82%A9%E3%83%AA%E3%82%AA%E3%82%92%E9%81%B8%E6%8A%9E%E3%81%99%E3%82%8B%E3%81%B9%E3%81%8D%E3%81%8B)
    - [マーケットリスクとユニークリスク](#%E3%83%9E%E3%83%BC%E3%82%B1%E3%83%83%E3%83%88%E3%83%AA%E3%82%B9%E3%82%AF%E3%81%A8%E3%83%A6%E3%83%8B%E3%83%BC%E3%82%AF%E3%83%AA%E3%82%B9%E3%82%AF)
- [資本コストとは？](#%E8%B3%87%E6%9C%AC%E3%82%B3%E3%82%B9%E3%83%88%E3%81%A8%E3%81%AF)
  - [WACCの計算式](#wacc%E3%81%AE%E8%A8%88%E7%AE%97%E5%BC%8F)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

## はじめに

事業会社ビジネスの領域でファイナンスを道具として用いることができるようになることを目的にこのノートをまとめています. ですので基本的には、

- ファイナンス理論の概要
- 計算機を使って実務でどのように使うのか？

の観点で記述していきます.

### 計算環境/Computation Language

- Python 3.6.9 (Google Colab)
- Spreadsheet

## ファイナンスとは？

企業の財務的な意思決定をファイナンスと呼びます. 企業は、資本市場から調達した資金を事業に投資します. 投資した資金は、企業活動を通じてリターンを生み出し、そのリターンを利息や配当や内部留保という形で処理していきます. この一連の流れが企業の財務的な意思決定の代表例となります. ですのでファイナンスという分野は以下の領域をカバーします：

- 投資先の意思決定
- 資金調達に関する意思決定
- 配当政策

## 投資判断

企業は投資なくしては、企業価値を高めることはできません. この投資判断の決定プロセスは

1. キャッシュフローの予測
2. 投資判断指標の計算
3. 計算結果と採択基準の比較
4. 予算と照らし合わせ投資するかどうかの意思決定する

という流れになります. 

### キャッシュフロー計算書(C/F)とは

キャッシュフロー計算書は、企業の活動を３つに分けて、１年間でどのような資金の流れがあったのか見るものです. 売上がたったときに資金回収がなされているか？、資金繰りの観点から企業経営は安定しているか？を判断する際に用いられます. ここでの資金とは、「現金及び現金同等物」に一般的には限定されます. 現金には、手元現金だけでなく、当座預金・普通預金・通知預金などの要求払預金も含まれます. また元気９ん同等物とは、容易に換金することができ、かつ価値の変動について僅少なリスクしか追わない短期投資のことを指します. 例えば、コマーシャルペーパーが挙げられます. 

---|---
営業活動CF|企業が主として営む事業に関連する活動であり、この区分では売上収入や商品・原材料の仕入れの支出、人件費や販売管理費の支出が代表例
投資活動CF|設備投資、証券投資、融資、固定資産への資本的支出など
財務活動CF|資金調達と返済から成る. 新規の買い入れや社債発行など

### 投資判断指標の例

|種類|定義|説明|
|---|---|---|
|Net Present Value(NPV)|将来発生するキャッシュフローの現在価値の合計額 - 初期投資額|NPV > 0 ならば企業価値を高めるプロジェクトなので投資<br>割引率はプロジェクトのリスクの度合いに応じで高く設定|
|資金回収期間ルール|予測されたキャッシュフローの合計が初期投資額と同額になるまでの期間<br><br>$\text{資金回収期間} = \frac{\text{投資額}}{\text{年間キャッシュインフロー}}$|期間が長いほどリスクが高いという判断ができるが、基準年をどのように設定するかは企業次第<br><br>基準年数後のキャッシュフローは考慮していない|
|収益性インデックス(PI)|$\text{PI} = \frac{キャッシュ・インフローの現在価値}{キャッシュ・アウトフローの現在価値}$|PI > 1 ならば実施すべき|
|内部収益率(IRR)|NPVがゼロとなる割引率|IRRが複数存在する場合は、低い方の割引率が採択される<br><br>→こちら[spreadsheet](https://docs.google.com/spreadsheets/d/12qMabffvdVt-YHYd1Fo37h40zt9OFLGk1uQwXac9e14/edit?usp=sharing)を参照|

**アメリカ企業の投資決定方法ランキング**

1999年にとったアンケートによると、70%以上の企業がIRRをNPVルールと同様に投資判断に採用していました. 「IRRは割引率を使わないで計算できて簡単だから」というのが理由とのことです.

<img src="https://github.com/ryonakimageserver/omorikaizuka/blob/master/%E3%83%96%E3%83%AD%E3%82%B0%E7%94%A8/20210429-corporate-finance-index.png?raw=true">


**NPVとIRRの比較**

IRRとNPVはハードルレート（最低限必要な割引率）の水準によっては、判断が異なる場合があります. 割引率の設定水準によって、どの期のリターンが重視されるかが異なることが原因となります. 例えば、高い割引率を設定している場合、未来のキャッシュフローよりも現在のキャッシュインフローが重要視され、その変化がNPVに反映されます. 具体的な数値例はこちらの[spreadsheet](https://docs.google.com/spreadsheets/d/12qMabffvdVt-YHYd1Fo37h40zt9OFLGk1uQwXac9e14/edit?usp=sharing)を参照.

なお、NPVルールとIRRルールとで結論が違う場合は、NPVルールに基づいて意思決定を行うことが推奨されます. なぜなら、投資活動のゴールは収益率を高めるためではなく、企業価値を高めることにあり、NPVが大きいほうが企業価値を高めるプロジェクトになるからです. 

### 資本支出予算管理 (capital budgeting)

通常はどの企業にも設備投資の予算枠というものがあり、その中でプロジェクトの優先順位をつけて投資の意思決定を行います. 例として、設備投資予算枠が5000万円のとき下記のどのプロジェクトに投資をするべきかを考えます.

|Project|投資金額|NPV|PI|Project Efficiency|
|---|---|---|---|---|
|A|5000|1000|1.20|0.2|
|B|1000|400|1.40|0.4|
|C|500|250|1.50|0.5|
|D|1500|500|1.33|0.33|
|E|3000|700|1.23|0.23|

すべてのプロジェクトで NPV > 0 を満たしているので、予算制約がない場合はすべてのプロジェクトを実行します. 今回は予算枠5000万円で企業価値を最大化したい場合です. この一つの解として、投資額１円あたりのNPVを「プロジェクトの効率性」(Project Efficiency)として考え、この数値が大きい順に投資の意思決定をすることが考えられます. 

$$
\text{Project Efficiency} = \frac{\text{NPV}}{\text{投資金額}}
$$

なおProject Efficiencyの順序は一般的にはPIと一致するので、PIをベースに意思決定することが多いです. 

### 異なる期間のプロジェクトを比較する場合

実務上では、期間が違うプロジェクトを比較検討する場合があります. 機械Aと機械Bのどちらか一方を購入するという意思決定をしなくてはならないケースを考えます. それぞれの機械の初期投資費用および現在価値に直されたキャッシュフローは

||機械A|機械B|
|---|---|---|
|初期投資|200|150|
|Discount rate|0.05|0.05|
|年度1|250|200|
|年度2|250|200|
|年度3|250|200|
|年度4|Null|200|
|年度5|Null|200|
|年度6|Null|200|

投資基準をNPVとして、このデータをもとにそれぞれのNPVを計算すると、機械A購入は481, 機械B購入は865となります. なので単純比較すると機械Bを購入したほうが良いと思われますが、機械Aを年度3で更新して合計６年使うという計画にすると, 機械A購入NPVは896となり、機械Aを購入したほうが良いという結論になります.

このように、異なる期間のプロジェクトを比較する場合は、(1) プロジェクト期間を揃えるか (2) Equivalent Annuitiesを計算し、一年あたりのNPVを計算するなどの調整が必要となります. 今回において、Equivalent Annuitiesを計算すると機械A購入は 176.56, 機械B購入は 170.45 となります.

### With-Wothoutの原則（機会費用）

投資判断をするためには、プロジェクトを実施した場合(With)のキャッシュフローと実施しなかった場合(Without)のキャッシュフローの比較で判断します.

```
\text{Project AのNPV} = \text{Project A実施時のNPV} - \text{Project A未実施のNPV}
```

なお、各プロジェクトのNPVが独立ではなく、シナジー効果やカニバリゼーションを伴う場合は、各プロジェクト組合せのNPVを計算した上で、投資意思決定をすべきとなります.

### リスクと不確実性

企業の投資判断におけるリスクの取扱について、基本的には回避/軽減できるならば回避/軽減することに越したことはないですが、描いた成長戦略を実現するためのアクションの選択において「先行きがわからない」というリスクは常につきものです. ですので、これから採択使用している投資が「リスクに見合ったリターンを生み出すか？」判断し続けることが重要となります. 

[こちらのGoogle Colab](https://colab.research.google.com/drive/1K_31UKEK1WZ3Pn6Paa5aG___U_7ChkI9?usp=sharing)ではファーストリテイリングの株価を例に、株式投資のリスクの高さを確認しています. 

リスクの高さを表す指標はいろいろ考えらますが、一般的には期待収益率の標準偏差で表現されることが多いです。

#### ポートフォリオの期待収益率と分散

- $$r_A$$: Project Aの収益率
- $$r_B$$: Project Bの収益率
- $$p_A, p_B$$: Project A, Project Bへの投資割合

このとき、Project AとProject Bへの投資の組み合わせからなるポートフォリオの収益率 $$r$$の期待値は

$$
\begin{aligned}
\mathbf E[r] &= \mathbf E[p_Ar_A + p_Br_B] \\
&= p_A\mathbf E[r_A] + p_B\mathbf E[r_B]
\end{aligned}
$$

ポートフォリオ収益率の分散は

$$
Var(r) = p_A^2 V(r_A) + p_B^2 V(r_B) + 2 Cov(r_A, r_B)
$$

計算例は[こちら](https://docs.google.com/spreadsheets/d/1IHw2ZerVBnS0MqK87XdREdUHIQlx06P_bPawGju7wgY/edit?usp=sharing)

#### どの水準のポートフォリオを選択するべきか？

<img src="https://github.com/ryonakimageserver/omorikaizuka/blob/master/%E3%83%96%E3%83%AD%E3%82%B0%E7%94%A8/20210429-portfolio-index.png?raw=true">

この例では、同じリスクで高い期待収益率をあげることができる集合を線分で分けることができます。この線分の上側の部分を効率的フロンティア(efficient frontier)と呼びます. 投資プロジェクトを組合せたポートフォリオの集合から投資先を選択する場合は、少なくともこの効率的フロンティアから選ばないといけません. 

また合理的な投資家は国債などのリスクフリー資産との組み合わせで投資先を決めます。その投資先決定に用いる指標の一つとして「シャープレイシオ」があります. 「シャープレイシオ」はポートフォリオがリスクに見合った運用実績を上げているか見る指標で、次のように求めます。

$$
\text{Sharp ratio} = \frac{\text{リスクプレミアム}}{\text{ポートフォリオのリスク}}
$$

ここでのリスクプレミアムは 

$$
\text{リスクプレミアム} = \text{ポートフォリオの期待収益} - \text{リスクフリーレート}
$$

となります. リスクを取ることによってどれだけ効率よくリターンを上げることができるかを表しています. この値が大きいほど、運用の効率が良いとされています. 

#### マーケットリスクとユニークリスク

```
株式のリスク = Market Risk + Unique Risk
```

とされています. 市場リスクは、経済全体に影響を与えるような景気、金利、為替変動によって引き起こされるリスクのことで、ポートフォリオで分散化しても減らすことには一定の限界があります. 一方、個別リスクは企業そのものや業界に関連した株式固有の要因によって発生するリスクです. 

## 資本コストとは？

企業は資金調達をして事業を営みます. この資金は原則 Debt(負債) と Equity(株式)の組み合わせによって調達されます. それぞれの資本調達は支払利息である負債コストと配当等の株主資本コストが発生します. 一般に「資本コスト」はこれら負債と株式の資本コストを加重平均で表現した「加重平均資本コストWACC」を意味します.

<img src="https://github.com/ryonakimageserver/omorikaizuka/blob/master/%E3%83%96%E3%83%AD%E3%82%B0%E7%94%A8/20210429-WACC-Basic.png?raw=true">

付加価値を生むためには資本コストを上回るリターンをあげる必要があり、これを経営者の受託者責任と呼びます. また、このWACCはNPVのDiscount rateとして用いられる事が多いです.

### WACCの計算式

$$
\text{WACC} = r_E\times \frac{E}{E+D} + r_D(1 - T_c)\times \frac{E}{E+D}
$$

- $$r_E$$: 株主資本コスト
- $$r_D$$: 負債コスト
- $$E$$: 株主資本（時価）
- $$D$$: 負債
- $$T_c$$: 実効税率(限界税率)

負債コストに実効税率の調整をしている理由は、利息は税務上損金に計上され、節税効果があるためです.

